<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jingzhi Ding" />

<meta name="date" content="2020-12-19" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Jingzhi Ding</h4>
<h4 class="date">2020-12-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This page shows all the homework answers using R in the ‘Statistical Computing’ course.</p>
</div>
<div id="homework-2020-09-22" class="section level2">
<h2>Homework-2020-09-22</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Use knitr to produce an example in the book which contains at least one figure.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>Use lattice package to compare the ECDF and CDF of random data from normal distribution.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb1-2"><a href="#cb1-2"></a>n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(n))</span>
<span id="cb1-4"><a href="#cb1-4"></a>y &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(n, n), <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">densityplot</span>(<span class="op">~</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>y,</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="dt">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">panel.densityplot</span>(x, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, ...)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">panel.mathdensity</span>(<span class="dt">dmath=</span>dnorm,</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="dt">args=</span><span class="kw">list</span>(<span class="dt">mean=</span><span class="kw">mean</span>(x), <span class="dt">sd=</span><span class="kw">sd</span>(x)),</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The larger the sample size, the better the fitting effect.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Use knitr to produce an example in the book which contains at least one table.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>Use linear Regression to fit data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>x1&lt;-<span class="kw">c</span>(<span class="fl">0.10</span>, <span class="fl">0.11</span>, <span class="fl">0.12</span>, <span class="fl">0.13</span>, <span class="fl">0.14</span>, <span class="fl">0.15</span>,</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fl">0.16</span>, <span class="fl">0.17</span>, <span class="fl">0.18</span>, <span class="fl">0.20</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>x2&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>y&lt;-<span class="kw">c</span>(<span class="fl">42.0</span>, <span class="fl">43.5</span>, <span class="fl">49.0</span>, <span class="fl">45.5</span>, <span class="fl">45.0</span>, <span class="fl">47.5</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fl">49.0</span>, <span class="fl">53.0</span>, <span class="fl">53.0</span>, <span class="fl">55.0</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>lm.sol&lt;-<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1<span class="op">+</span>x2)</span>
<span id="cb2-7"><a href="#cb2-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(lm.sol)<span class="op">$</span>coef)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">31.4931670</td>
<td align="right">3.2740465</td>
<td align="right">9.619035</td>
<td align="right">0.0000276</td>
</tr>
<tr class="even">
<td align="left">x1</td>
<td align="right">123.5357918</td>
<td align="right">19.8256005</td>
<td align="right">6.231125</td>
<td align="right">0.0004320</td>
</tr>
<tr class="odd">
<td align="left">x2</td>
<td align="right">-0.4264642</td>
<td align="right">0.4261351</td>
<td align="right">-1.000772</td>
<td align="right">0.3502682</td>
</tr>
</tbody>
</table>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Use knitr to produce an example in the book which contains at least a couple of Latex formulas.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>Pdf of multivariate normal distribution: <span class="math display">\[f_{\mathbf{x}}\left(x_{1}, \ldots, x_{k}\right)=\frac{1}{\sqrt{(2 \pi)^{k}|\mathbf{\Sigma}|}} \exp \left(-\frac{1}{2}(\mathbf{x}-\boldsymbol{\mu})^{\mathrm{T}} \mathbf{\Sigma}^{-1}(\mathbf{x}-\boldsymbol{\mu})\right)\]</span></p>
</div>
<div id="homework-2020-09-29" class="section level2">
<h2>Homework-2020-09-29</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>The Pareto <span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math inline">\(F(x)=1-\left(\frac{b}{ x}\right)^{a}\)</span>, <span class="math inline">\(x\ge b&gt;0, a&gt;0\)</span>. Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p>Use inverse transform algorithm:</p>
<p><span class="math inline">\(U=F_X(X)\sim Uniform(0,1)\)</span></p>
<p><span class="math inline">\(X=F_X^{-1}(U)=b(1-U)^{-\frac{1}{a}}\)</span></p>
<p>Generate <span class="math inline">\(U\)</span> and return <span class="math inline">\(X=F_X^{-1}(U)\)</span> when <span class="math inline">\(a=b=2\)</span>. Use 1000 sample to graph the density histogram for comparison.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>f1=<span class="cf">function</span>(n,a,b){</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#n: sample size; Pareto(a,b)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>u=<span class="kw">runif</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x=b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a) </span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(a<span class="op">*</span>b<span class="op">^</span>a)<span class="op">/</span>x<span class="op">^</span>(a<span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb3-6"><a href="#cb3-6"></a>y=<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">100</span>, <span class="fl">.01</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">lines</span>(y, (a<span class="op">*</span>b<span class="op">^</span>a)<span class="op">/</span>y<span class="op">^</span>(a<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>}</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">f1</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The red curve shows the Pareto density.The histogram is basically the same as the trend of the density function curve. It can be considered that the distribution of random observations from inverse transform algorithm is Pareto distribution. The algorithm works well.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),|x|\le1\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\sim\)</span>Uniform(-1,1). If <span class="math inline">\(|U_3|\ge|U_2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>First independently produce 3 random numbers from Uniform(-1,1). Then compare their absolute values and output the random number we need. Use loop statements to produce more random number. The sample size is 5000.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>f2=<span class="cf">function</span>(n){</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#n:sample size</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>k=<span class="dv">0</span>;</span>
<span id="cb4-4"><a href="#cb4-4"></a>y=<span class="kw">numeric</span>(n);</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="cf">while</span>(k<span class="op">&lt;</span>n){</span>
<span id="cb4-6"><a href="#cb4-6"></a>  u1=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>  u2=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>  u3=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>  k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="cf">if</span> ((<span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u2))<span class="op">&amp;&amp;</span>(<span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u1))){</span>
<span id="cb4-11"><a href="#cb4-11"></a>    y[k]=u2;}</span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="cf">else</span>{</span>
<span id="cb4-13"><a href="#cb4-13"></a>    y[k]=u3;}</span>
<span id="cb4-14"><a href="#cb4-14"></a>}</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="kw">hist</span>(y,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y)<span class="op">==-</span><span class="fl">0.25</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span><span class="fl">+0.75</span><span class="op">*</span>x<span class="fl">+0.5</span>))</span>
<span id="cb4-16"><a href="#cb4-16"></a>}</span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="kw">f2</span>(<span class="dv">5000</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e(x)=\frac{3}{4}(1-x^2),|x|\le1\)</span>.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>The random variable <span class="math inline">\(U\)</span> generates from <span class="math inline">\(U_2\)</span> or <span class="math inline">\(U_3\)</span>. So we can figure out the cdf of <span class="math inline">\(U\)</span> and get its pdf to prove this.</p>
<p>Since iid <span class="math inline">\(U_1,U_2,U_3\sim\)</span>Uniform(-1,1), the pdf of U(-1,1) is <span class="math inline">\(p(u_i)=\frac{1}{2}I_{\left\{-1\le u_i\le 1\right\}}\)</span>, <span class="math inline">\(i=1,2,3\)</span></p>
<p>The jpdf of <span class="math inline">\(U_1,U_2,U_3\)</span> is <span class="math inline">\(p(u1,u2,u3)=\frac{1}{8}I_{\left\{-1\le u_1\le 1,-1\le u_2\le 1,-1\le u_3\le 1\right\}}\)</span></p>
<p><span class="math display">\[\begin{align*}
F_U(x)&amp;=P(U&lt;x)=P(U&lt;U_2,output=U_2)+P(U&lt;U_3,output=U_3)\\
&amp;=P(U&lt;U_2,|U_3|\ge|U_2|,|U_3|\ge|U_1|)+P(U&lt;U_3,|U_3|&lt;|U_2| or |U_3|&lt;|U_1|)\\
&amp;=P_1+P_2\\
P_1&amp;=\frac{1}{8}\int_{-1}^{x}du_2\int_{|U_3|\ge|U_2|}du_3\int_{|U_3|\ge|U_1|}du_1 \\
&amp;=\frac{1}{8}\int_{-1}^{x}du_2\int_{|U_3|\ge|U_2|}(1-u_3)du_3\\
&amp;=-\frac{1}{12} x^3+\frac{x}{4}\\
P_2&amp;=P(U_3\le x)-P(U_3\le x,|U_3|\ge|U_2|,|U_3|\ge|U_1|)\\
&amp;=\frac{x+1}{2}-\int_{-1}^{x}du_3\int_{|U_3|\ge|U_2|}du_2\int_{|U_3|\ge|U_1|}du_1\\
&amp;=\frac{1}{2}x-\frac{1}{6}x^3\\
F_U(x)&amp;=P(U&lt;x)=-\frac{1}{12} x^3+\frac{x}{4}+\frac{1}{2}x-\frac{1}{6}x^3\\
&amp;=-\frac{1}{4}x^3+\frac{3x}{4}\\
f_U(x)&amp;=(-\frac{1}{4}x^3+\frac{3x}{4})&#39;\\
&amp;=\frac{3}{4}(1-x^2)=f_e
\end{align*}\]</span> So the algorithm given in question 2 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r,y\ge0.\]</span> Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical(Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>Generate 1000 sample from <span class="math inline">\(Gamma(4,2)\)</span> and then generate 1000 sample from <span class="math inline">\(Exp(\lambda)\)</span> given <span class="math inline">\(\lambda\)</span>. The Pareto distribution has pdf <span class="math inline">\(f(y)=\frac{r\beta ^r}{(\beta+y)^{r+1}}\)</span>. When <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>, <span class="math inline">\(f(y)=\frac{64}{(2+y)^5}\)</span>. Use 1000 sample to gragh the histogram and compare with the pdf of Pareto distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n=<span class="dv">1000</span>;</span>
<span id="cb5-2"><a href="#cb5-2"></a>r=<span class="dv">4</span>;</span>
<span id="cb5-3"><a href="#cb5-3"></a>beta=<span class="dv">2</span>;</span>
<span id="cb5-4"><a href="#cb5-4"></a>lameda=<span class="kw">rgamma</span>(n,r,beta);</span>
<span id="cb5-5"><a href="#cb5-5"></a>x=<span class="kw">rexp</span>(n,lameda)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>y=<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="fl">.01</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">lines</span>(y, r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">*</span>(beta<span class="op">+</span>y)<span class="op">^</span>(<span class="op">-</span>r<span class="dv">-1</span>),<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The red curve shows the Pareto density with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.The histogram is basically the same as the trend of the density function curve. It can be considered that the distribution of random observations from the mixture is Pareto distribution.</p>
</div>
<div id="homework-2020-10-13" class="section level2">
<h2>Homework-2020-10-13</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Compute a Monte Carlo estimate of <span class="math inline">\(\int_{0}^{\pi/3}sintdt\)</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>Figure out the exact value of the integral for comparation. <span class="math inline">\(\int_{0}^{\pi/3}sintdt=\frac{\pi}{3}E(sint)\)</span>, <span class="math inline">\(t\sim U(0,\frac{\pi}{3})\)</span> Generate number from <span class="math inline">\(U(0,\frac{\pi}{3})\)</span> and use a frequency to approximate the expectation. Figure out the exact value of the integral for comparison. <span class="math display">\[\int_{0}^{\pi/3}sintdt=-cos(\pi/3)+cos0=\frac{1}{2}\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>sample_size=<span class="dv">10000</span>;</span>
<span id="cb6-2"><a href="#cb6-2"></a>t=<span class="kw">runif</span>(sample_size,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)<span class="co">#generate 10000 number from U(0,pi/3)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>int_hat=<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span> <span class="co">#estimate the value of the integral</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>int_exact=<span class="fl">0.5</span>;</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">print</span>(<span class="kw">c</span>(int_hat,int_exact))<span class="co">#outout the estimate and the exact value</span></span></code></pre></div>
<pre><code>## [1] 0.4961169 0.5000000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">print</span>(<span class="kw">abs</span>(int_hat<span class="op">-</span>int_exact))<span class="co">#the absolute value of the difference </span></span></code></pre></div>
<pre><code>## [1] 0.003883119</code></pre>
<p>It can be considered that when the sample size is large, the difference between the estimate and exact value is rather small. The simple Monte Carlo estimator works well.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>First, compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U)\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>: <span class="math display">\[Cov(e^U,e^{1-U})=eCov(e^U,e^{1-U})=e[1-Ee^UEe^{-U}]=-e^2+3e-1\]</span> <span class="math display">\[Var(e^U)=Ee^{2U}-[Ee^U]^2=-0.5e^2+2e-1.5\]</span> <span class="math display">\[Var(e^{-U})=-1.5e^{-2}+2e^{-1}-0.5\]</span> <span class="math display">\[Var(e^U+e^{1-U})=-3e^2+10e+5\]</span> For the antithetic variate approach, <span class="math inline">\(Var(\frac{e^U+e^{1-U}}{2})=-1.5e^2+5e+2.5\)</span> Use simple Monte Carlo method to estimate <span class="math inline">\(\theta\)</span>: <span class="math display">\[\theta=\int_{0}^{1}e^xdx=E(e^x),x\sim U(0,1)\]</span> Generate number from <span class="math inline">\(U(0,\frac{\pi}{3})\)</span> and use a frequency to approximate the expectation. Then compute the empirical estimate of variance.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>sample_size=<span class="dv">10000</span>;</span>
<span id="cb10-2"><a href="#cb10-2"></a>t=<span class="kw">runif</span>(sample_size<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="co">#generate 5000 number from U(0,1) for antithetic variate approach</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>v1=<span class="kw">runif</span>(sample_size<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)<span class="co">#generate another 5000 number from U(0,1) for simple MC</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>u1=<span class="kw">c</span>(t,v1)<span class="co">#random number for simple MC method</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>e=<span class="kw">exp</span>(<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>P1=e<span class="op">^</span>u1</span>
<span id="cb10-7"><a href="#cb10-7"></a>P2=(e<span class="op">^</span>u1<span class="op">+</span>e<span class="op">^</span>(<span class="dv">1</span><span class="op">-</span>u1))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>int_hat1=<span class="kw">mean</span>(P1) <span class="co">#estimate the value of the integral with simple MC method</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>int_hat2=<span class="kw">mean</span>(P2)</span>
<span id="cb10-10"><a href="#cb10-10"></a>int_exact=e<span class="dv">-1</span>;</span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="kw">print</span>(<span class="kw">c</span>(int_hat1,int_hat2,int_exact))<span class="co">#output the two estimate and the exact value</span></span></code></pre></div>
<pre><code>## [1] 1.710278 1.718692 1.718282</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(P1),<span class="kw">var</span>(P2)))</span></code></pre></div>
<pre><code>## [1] 0.242357983 0.003928745</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>var1=<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>e<span class="fl">-1.5</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>var2=(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">10</span><span class="op">*</span>e<span class="dv">-5</span>)<span class="op">/</span><span class="dv">4</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>reduction=(var1<span class="op">-</span>var2)<span class="op">/</span>var1</span>
<span id="cb14-4"><a href="#cb14-4"></a>reductionhat=(<span class="kw">var</span>(P1)<span class="op">-</span><span class="kw">var</span>(P2))<span class="op">/</span><span class="kw">var</span>(P1)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">print</span>(<span class="kw">c</span>(var1,var2))<span class="co">#Var(e^u),Var((e^u+e^(1-u))/2)</span></span></code></pre></div>
<pre><code>## [1] 0.242035607 0.003912497</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">print</span>(<span class="kw">c</span>(reduction,reductionhat))</span></code></pre></div>
<pre><code>## [1] 0.9838350 0.9837895</code></pre>
<p>It can be seen that the difference among the estimates by two approaches and exact value is rather small while the exact result is 1.718282. Also, the estimates of varience are close to the exact value. The antithetic variate approach reduces the variate by about 98%.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>It <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> id the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta_c}=c\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta_c}=c\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span>.(<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators)</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p><span class="math display">\[\begin{align*}
\hat{\theta_c}&amp;=c\hat{\theta_1}+(1-c)\hat{\theta_2}\\
Var(\hat{\theta_c})&amp;=Var(\hat{\theta}_2)+c^2(Var(\hat{\theta}_1-\hat{\theta}_2))+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)\\
&amp;=Var(\hat{\theta}_1-\hat{\theta}_2)(c+\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)})^2+\frac{Var(\hat{\theta}_1-\hat{\theta}_2)Var(\hat{\theta}_2)-Cov^2(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}
\end{align*}\]</span> Thus, when <span class="math inline">\(c^*=-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}=\frac{-Cov(\hat{\theta}_2,\hat{\theta}_1)+Var(\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span>, the estimator reaches the minimum and <span class="math inline">\(Var(\hat{\theta_c})=\frac{Var(\hat{\theta}_1-\hat{\theta}_2)Var(\hat{\theta}_2)-Cov^2(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}\)</span></p>
</div>
<div id="homework-2020-10-20" class="section level2">
<h2>Homework-2020-10-20</h2>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supposed on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, x&gt;1\]</span></p>
<p>Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> by importance sampling? Explain.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>Choose two important functions which are ‘close’ to <span class="math inline">\(g\)</span>. Their image is as follows. The blue line represents <span class="math inline">\(f_1\)</span> while the blue line represents <span class="math inline">\(f_2\)</span>. The black line show the function <span class="math inline">\(g\)</span>. <span class="math display">\[f_1=\frac{1}{2}e^{-\frac{1}{2}(x-1)},x&gt;1\]</span> <span class="math display">\[f_2=\frac{4}{\pi(1+x^2)},x&gt;1\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#plot the function graph for comparison</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>g=<span class="cf">function</span>(x) (x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>f1=<span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(x<span class="dv">-1</span>))</span>
<span id="cb18-4"><a href="#cb18-4"></a>f2=<span class="cf">function</span>(x) (<span class="dv">4</span><span class="op">/</span>pi)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw">plot</span>(g,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>),<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">plot</span>(f1,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">add=</span>T)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">plot</span>(f2,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>),<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">add=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> For <span class="math inline">\(\int_1^{\infty} \frac{g(x)}{f(x)}f(x)dx=E(g(x)/f(x))\)</span>, generate random numbers from <span class="math inline">\(f\)</span>. Then figure out the result by <span class="math inline">\(\hat{\theta}=\frac{1}{m}\sum_{i=1}^n\frac{g(X_i)}{f(X_i)}\)</span>.</p>
<p>When the important function is <span class="math inline">\(f_1=\frac{1}{2}e^{-\frac{1}{2}(x-1)},x&gt;1\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#x~f Y=X+1~exp(0.5)</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#thus we just need to generate number from exp(0.5)</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>n=<span class="dv">10000</span>;</span>
<span id="cb19-4"><a href="#cb19-4"></a>ratio=<span class="kw">numeric</span>(n);</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb19-6"><a href="#cb19-6"></a>  u=<span class="kw">rexp</span>(<span class="dv">1</span>,<span class="fl">0.5</span>)<span class="op">+</span><span class="dv">1</span>;</span>
<span id="cb19-7"><a href="#cb19-7"></a>  ratio[i]=<span class="kw">g</span>(u)<span class="op">/</span><span class="kw">f1</span>(u);</span>
<span id="cb19-8"><a href="#cb19-8"></a>}</span>
<span id="cb19-9"><a href="#cb19-9"></a>result1=<span class="kw">mean</span>(ratio)</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="kw">print</span>(result1)<span class="co">#the result</span></span></code></pre></div>
<pre><code>## [1] 0.4008173</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">print</span>(<span class="kw">var</span>(ratio))<span class="co">#the variance using f1</span></span></code></pre></div>
<pre><code>## [1] 0.09135735</code></pre>
<p>When the important function is <span class="math inline">\(f_2=\frac{4}{\pi(1+x^2)},x&gt;1\)</span>.Use the inverse transform method to generate number from <span class="math inline">\(f_2\)</span>. <span class="math inline">\(F_2(x)=\frac{4}{\pi}arctanx-1\)</span> <span class="math inline">\(X=tan(\frac{\pi}{4}(U-1))\)</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>n=<span class="dv">10000</span>;</span>
<span id="cb23-2"><a href="#cb23-2"></a>ratio=<span class="kw">numeric</span>(n);</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb23-4"><a href="#cb23-4"></a>u0=<span class="kw">runif</span>(<span class="dv">1</span>);</span>
<span id="cb23-5"><a href="#cb23-5"></a>u=<span class="kw">tan</span>((pi<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(u0<span class="op">+</span><span class="dv">1</span>))<span class="co">##inverse transform method</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>ratio[i]=<span class="kw">g</span>(u)<span class="op">/</span><span class="kw">f2</span>(u);</span>
<span id="cb23-7"><a href="#cb23-7"></a>}</span>
<span id="cb23-8"><a href="#cb23-8"></a>result2=<span class="kw">mean</span>(ratio)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="kw">print</span>(result2)<span class="co">#the result</span></span></code></pre></div>
<pre><code>## [1] 0.3967965</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">print</span>(<span class="kw">var</span>(ratio))<span class="co">#the variance using f2</span></span></code></pre></div>
<pre><code>## [1] 0.1106254</code></pre>
<p>Obviously. the results of the integral are almost the same. From the results we can see that the variance of the first experiment is smaller than the second, which means <span class="math inline">\(f_1\)</span> is better to be an important function to solve this problem than <span class="math inline">\(f_2\)</span>. This is because <span class="math inline">\(f_1\)</span> is ‘closer’ to <span class="math inline">\(g\)</span> than <span class="math inline">\(f2\)</span> thus reduce variance well. The variance of <span class="math inline">\(\hat{\theta}\)</span> is <span class="math inline">\(Var(\frac{g(X)}{f(X)})/m\)</span>, and the minimal is value 0 when <span class="math inline">\(g=cf\)</span> in which <span class="math inline">\(c\)</span> is a constant.</p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>Since the density function we choose is not the uniform distribution function. Thus its integal over 5 intervals is not value 1. As a result, we need to modify the function first. <span class="math display">\[\int_{j-1/5}^{j/5} \frac{c_0e^{-x}}{1-e^{-1}}dx=1\]</span> <span class="math display">\[c_0=\frac{1-e^{-1}}{e^{-(j-1)/5}-e^{-j/5}}\]</span> Define the important function <span class="math inline">\(f(x)=ce^{-x}\)</span>，<span class="math inline">\(c=\frac{1}{e^{-(j-1)/5}-e^{-j/5}}\)</span> and <span class="math inline">\(j=1,2,3,4,5\)</span>.</p>
<p>Repeat the process for 50 times and figure out the mean and the standard deviation of the result.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>M=<span class="dv">1000</span>; k=<span class="dv">5</span> <span class="co">#5 layers</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>r=M<span class="op">/</span>k</span>
<span id="cb27-3"><a href="#cb27-3"></a>N=<span class="dv">50</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>T=<span class="kw">numeric</span>(k)</span>
<span id="cb27-5"><a href="#cb27-5"></a>g=<span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="co">#def g(x)</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>c=<span class="cf">function</span>(j) <span class="dv">1</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)) <span class="co">#def the coefficient c, which changes with j</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>ff=<span class="cf">function</span>(x,j) <span class="dv">1</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="co">#def f(x)</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>est=<span class="kw">numeric</span>(N)</span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){<span class="co">#repeat calculation for N times</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){<span class="co">#use important function </span></span>
<span id="cb27-11"><a href="#cb27-11"></a>    u=<span class="kw">runif</span>(r)</span>
<span id="cb27-12"><a href="#cb27-12"></a>    x0=(j<span class="dv">-1</span>)<span class="op">/</span>k</span>
<span id="cb27-13"><a href="#cb27-13"></a>    x=<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>x0)<span class="op">-</span>u<span class="op">/</span><span class="kw">c</span>(j))</span>
<span id="cb27-14"><a href="#cb27-14"></a>    T[j]=<span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">ff</span>(x,j))}</span>
<span id="cb27-15"><a href="#cb27-15"></a>  est[i]=<span class="kw">sum</span>(T)</span>
<span id="cb27-16"><a href="#cb27-16"></a>}</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="kw">print</span>(<span class="kw">mean</span>(est))</span></code></pre></div>
<pre><code>## [1] 0.5248142</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">print</span>(<span class="kw">sd</span>(est))<span class="co"># estimate the sd of the result</span></span></code></pre></div>
<pre><code>## [1] 0.0005255247</code></pre>
<p>In Example 5.10, the estimate <span class="math inline">\(\hat{\theta}=0.5257801\)</span> and the standard error is <span class="math inline">\(0.0970314\)</span>. By dividing the interval into 5 subintervals and use different important functions, we reduce the standard error a lot, which is smaller than 0.001. It turns out that it is a good choice to combine the importance sampling and stratified sampling to reduce variance although it costs more time for computing.</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>Define <span class="math inline">\(Y=lnX\)</span>, for <span class="math inline">\(Y \sim N(\mu,\sigma^2)\)</span>, <span class="math display">\[\frac{\sqrt{n}( \bar{y}-\mu)}{s} \sim N(0,1)\]</span> <span class="math display">\[s=\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i-\bar y)^2}\]</span> The 95% confidence interval of the unknown parameter <span class="math inline">\(\mu\)</span> is <span class="math display">\[[\bar y-t_{1-\alpha /2}(n-1)s/\sqrt{n},\bar y+t_{1-\alpha /2}(n-1)s/\sqrt{n}],y=lnx\]</span> Use Monte Carlo method to estimate the confidence level: Assuming that the distribution is <span class="math inline">\(LN(3,3^2)\)</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>n=<span class="dv">1000</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>N=<span class="dv">1000</span><span class="co">#repeat the process to estimate the confidence level</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>k=<span class="dv">0</span>;</span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb31-6"><a href="#cb31-6"></a>X=<span class="kw">rlnorm</span>(n,<span class="dv">3</span>,<span class="dv">3</span>)<span class="co">#random number from LN(3,3^2)</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>t=<span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a>left=<span class="kw">mean</span>(<span class="kw">log</span>(X))<span class="op">-</span>t<span class="op">*</span><span class="kw">sd</span>(<span class="kw">log</span>(X))<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb31-9"><a href="#cb31-9"></a>right=<span class="kw">mean</span>(<span class="kw">log</span>(X))<span class="op">+</span>t<span class="op">*</span><span class="kw">sd</span>(<span class="kw">log</span>(X))<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="cf">if</span>((left<span class="op">&lt;=</span><span class="dv">3</span>)<span class="op">&amp;&amp;</span>(right<span class="op">&gt;=</span><span class="dv">3</span>))</span>
<span id="cb31-11"><a href="#cb31-11"></a>    k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>}</span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="kw">print</span>(k<span class="op">/</span>N)<span class="co">#the confidence level</span></span></code></pre></div>
<pre><code>## [1] 0.955</code></pre>
<p>From the result we can see that the corresponding ECP based on 1000 experiments almost equals to 0.95. The results will be vary but they should be very close to <span class="math inline">\(1-\alpha\)</span>. We can consider that this confidence interval is useful.</p>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance. )</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>Since <span class="math inline">\(X \sim \chi ^2(2)\)</span>, use t-interval to estimate the mean.</p>
<p>The 95% confidence interval of the unknown parameter <span class="math inline">\(\mu\)</span> is <span class="math display">\[[\bar x-t_{1-\alpha /2}(n-1)s/\sqrt{n},\bar x+t_{1-\alpha /2}(n-1)s/\sqrt{n}]\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>n=<span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>N=<span class="dv">1000</span><span class="co">#repeat times</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>k=<span class="dv">0</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>af=<span class="fl">0.05</span><span class="co">#alpha</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>left=<span class="kw">numeric</span>(N);</span>
<span id="cb33-7"><a href="#cb33-7"></a>right=<span class="kw">numeric</span>(N);</span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb33-9"><a href="#cb33-9"></a>X=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a>t=<span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)</span>
<span id="cb33-11"><a href="#cb33-11"></a>left[i]=<span class="kw">mean</span>(X)<span class="op">-</span>t<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb33-12"><a href="#cb33-12"></a>right[i]=<span class="kw">mean</span>(X)<span class="op">+</span>t<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="cf">if</span>((left[i]<span class="op">&lt;=</span><span class="dv">2</span>)<span class="op">&amp;&amp;</span>(right[i]<span class="op">&gt;=</span><span class="dv">2</span>))<span class="co">#Monte Carlo experiment to estimate the coverage probability</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>    k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>}</span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="kw">print</span>(k<span class="op">/</span>N) <span class="co"># the coverage probability</span></span></code></pre></div>
<pre><code>## [1] 0.924</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">print</span>(<span class="kw">sd</span>(left))</span></code></pre></div>
<pre><code>## [1] 0.3127481</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">print</span>(<span class="kw">sd</span>(right))<span class="co"># the sd of the CI</span></span></code></pre></div>
<pre><code>## [1] 0.6602117</code></pre>
<p>Repeat the process 1000 times to figure out the coverage probability and the standard deviation of the CI. From the result we can find that the coverage probability is smaller than the theoretical value. This CI is liberal because the distribution of the sample is not normal distribution.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>n=<span class="dv">20</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>N=<span class="dv">1000</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>a=<span class="fl">0.05</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>sigma=<span class="dv">2</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>UCL=<span class="kw">numeric</span>(N)</span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb39-8"><a href="#cb39-8"></a>Y=<span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb39-9"><a href="#cb39-9"></a>UCL[i]=(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(Y)<span class="op">/</span><span class="kw">qchisq</span>(a,n<span class="dv">-1</span>)}</span>
<span id="cb39-10"><a href="#cb39-10"></a>s=<span class="kw">sum</span>(sigma<span class="op">&lt;=</span>UCL)</span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="kw">print</span>(s<span class="op">/</span>N)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">print</span>(<span class="kw">sd</span>(UCL))</span></code></pre></div>
<pre><code>## [1] 2.38851</code></pre>
<p>Compare the result with Example 4, the standard deviation of the UCL is bigger than that in Question 4. This means that the t-interval is more robust than the interval for variance. However, the coverage probability of example 4.2 is bigger than 0.95, which is better than the t-interval for non-normal distribution.</p>
</div>
<div id="homework-2020-10-27" class="section level2">
<h2>Homework-2020-10-27</h2>
</div>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>The skewness of a variable is defined by <span class="math display">\[\sqrt{\beta_1}=\frac{E[(X-\mu_X)]^3}{\sigma^3_X}\]</span></p>
<p>The sample skewness is defined as: <span class="math display">\[\sqrt{(b_1)}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar X)^3}{(\frac{1}{n}\sum_{i=1}^n(X_i-\bar X)^2)^{3/2}}\]</span> The hypotheses are:<span class="math inline">\(H_0:\sqrt{\beta_1}=0\)</span> vs <span class="math inline">\(H_1:\sqrt{\beta_1}\ne0\)</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co">#define a function to compute the sample skewness coeff</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>sk=<span class="cf">function</span>(x) {</span>
<span id="cb43-4"><a href="#cb43-4"></a>xx=<span class="kw">mean</span>(x)</span>
<span id="cb43-5"><a href="#cb43-5"></a>e3=<span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xx)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb43-6"><a href="#cb43-6"></a>e2=<span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xx)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="kw">return</span>( e3 <span class="op">/</span><span class="st"> </span>e2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb43-8"><a href="#cb43-8"></a>}</span>
<span id="cb43-9"><a href="#cb43-9"></a>n=<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">500</span>);</span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="co">#different sample size</span></span>
<span id="cb43-11"><a href="#cb43-11"></a>l=<span class="kw">length</span>(n)</span>
<span id="cb43-12"><a href="#cb43-12"></a>m=<span class="dv">10000</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>a=<span class="dv">2</span><span class="co">#beta distribition beta(a,a)</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>nu=<span class="dv">5</span><span class="co">#t-distribution t(5)</span></span>
<span id="cb43-15"><a href="#cb43-15"></a>alpha=<span class="fl">0.05</span><span class="co">#confidence level</span></span>
<span id="cb43-16"><a href="#cb43-16"></a>w=<span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="co">#alternative hypothesis</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>test1=test2=<span class="kw">numeric</span>(m)</span>
<span id="cb43-18"><a href="#cb43-18"></a></span>
<span id="cb43-19"><a href="#cb43-19"></a>result.beta=result.t=<span class="kw">numeric</span>(l)</span>
<span id="cb43-20"><a href="#cb43-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l){</span>
<span id="cb43-21"><a href="#cb43-21"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb43-22"><a href="#cb43-22"></a>    x=<span class="kw">rbeta</span>(n[i],a,a)</span>
<span id="cb43-23"><a href="#cb43-23"></a>    y=<span class="kw">rt</span>(n[i],nu)</span>
<span id="cb43-24"><a href="#cb43-24"></a>    test1[j]=<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>w[i])</span>
<span id="cb43-25"><a href="#cb43-25"></a>    test2[j]=<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(y)) <span class="op">&gt;=</span><span class="st"> </span>w[i])</span>
<span id="cb43-26"><a href="#cb43-26"></a>  }</span>
<span id="cb43-27"><a href="#cb43-27"></a>result.beta[i]=<span class="kw">mean</span>(test1)<span class="co">#beta distribution</span></span>
<span id="cb43-28"><a href="#cb43-28"></a>result.t[i]=<span class="kw">mean</span>(test2)<span class="co">#t distribution</span></span>
<span id="cb43-29"><a href="#cb43-29"></a>}</span>
<span id="cb43-30"><a href="#cb43-30"></a><span class="kw">print</span>(result.beta)</span></code></pre></div>
<pre><code>## [1] 0.0040 0.0011 0.0005</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">print</span>(result.t)</span></code></pre></div>
<pre><code>## [1] 0.1644 0.3990 0.5650</code></pre>
<p>From the result we can see that the results of beta distribution is different from t distribution. This is because t distribution is heavy-tailed while beta distribution is not. Thus, the power of t distribution is larger when sample size increasing.</p>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}=0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>The hypotheses are:<span class="math inline">\(H_0:\sigma_1^2=\sigma_2^2\)</span> vs <span class="math inline">\(H_1:\sigma_1^2 \ne \sigma_2^2\)</span></p>
<p>Define the function returns the value 0(reject <span class="math inline">\(H_0\)</span>) or 1(not reject <span class="math inline">\(H_0\)</span>)</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">#count5test function</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co">#reject H0:return 1; not reject H0:return 0</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(a, b) {</span>
<span id="cb47-4"><a href="#cb47-4"></a>A=a<span class="op">-</span><span class="kw">mean</span>(a)</span>
<span id="cb47-5"><a href="#cb47-5"></a>B=b<span class="op">-</span><span class="kw">mean</span>(b)</span>
<span id="cb47-6"><a href="#cb47-6"></a>px=<span class="kw">sum</span>(A <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(B)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(A <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(B))</span>
<span id="cb47-7"><a href="#cb47-7"></a>py=<span class="kw">sum</span>(B <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(A)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(B <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(A))</span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(px, py)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb47-10"><a href="#cb47-10"></a>}</span>
<span id="cb47-11"><a href="#cb47-11"></a></span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="co">#comparison of count5test and F-test</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>sigma1=<span class="dv">1</span></span>
<span id="cb47-14"><a href="#cb47-14"></a>sigma2=<span class="fl">1.5</span></span>
<span id="cb47-15"><a href="#cb47-15"></a>ahat=<span class="fl">0.055</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>m=<span class="dv">10000</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>n=<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb47-18"><a href="#cb47-18"></a><span class="co">#test for small, medium, and large sample sizes</span></span>
<span id="cb47-19"><a href="#cb47-19"></a>power1=power2=<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="co">#power1--count5test; power2--F-test</span></span>
<span id="cb47-21"><a href="#cb47-21"></a>c=f=<span class="kw">numeric</span>(m)</span>
<span id="cb47-22"><a href="#cb47-22"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb47-23"><a href="#cb47-23"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb47-24"><a href="#cb47-24"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb47-25"><a href="#cb47-25"></a>x=<span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb47-26"><a href="#cb47-26"></a>y=<span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb47-27"><a href="#cb47-27"></a>c[j]=<span class="kw">count5test</span>(x, y)</span>
<span id="cb47-28"><a href="#cb47-28"></a>f.sol=<span class="kw">var.test</span>(x,y,<span class="dt">ratio=</span><span class="dv">1</span>,<span class="dt">conf.level =</span> ahat)<span class="co">#F-test</span></span>
<span id="cb47-29"><a href="#cb47-29"></a>f[j]=(f.sol<span class="op">$</span>p.value<span class="op">&lt;</span>ahat)<span class="co">#compare the p-value</span></span>
<span id="cb47-30"><a href="#cb47-30"></a>}</span>
<span id="cb47-31"><a href="#cb47-31"></a>power1[i]=<span class="kw">mean</span>(c) </span>
<span id="cb47-32"><a href="#cb47-32"></a>power2[i]=<span class="kw">mean</span>(f) </span>
<span id="cb47-33"><a href="#cb47-33"></a>}</span>
<span id="cb47-34"><a href="#cb47-34"></a><span class="kw">print</span>(power1)<span class="co">#count5test</span></span></code></pre></div>
<pre><code>## [1] 0.3196 0.8475 0.9979</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">print</span>(power2)<span class="co">#F-test</span></span></code></pre></div>
<pre><code>## [1] 0.4270 0.9817 1.0000</code></pre>
<p>We can find that when the sample size become larger, the power will be larger as a result, which is close to 1. This means that larger sample size guarantee a more precise test. Also, by comparing the result of the two test methods, it is obvious that F-test maybe better for its bigger power. This is because F-test is applicable for sample from normal distribution.</p>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math inline">\(\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\)</span>. Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math inline">\(b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<p>The skew of multivariate is defined by: <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> First, define a function ‘msk’ to calculate the multivariate population skewness of the sample: <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3\]</span> <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance, which is the sample covariance.</p>
<p>The hypotheses are:<span class="math inline">\(\sqrt{\beta_{1,d}}=0\)</span> vs <span class="math inline">\(H_1:\sqrt{\beta_{1,d}} \ne 0\)</span></p>
<p>The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom. As a result, we can figure out the quantile to calculate the p-value.</p>
<p>Example 6.8</p>
<p>Since this case is more complicated than the original example, which is difficult for my computer to complete this task. I change the cycle times from 10000 to 100. Choose different sample size and analyze the results.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">#Example 6.8</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb51-3"><a href="#cb51-3"></a>skw&lt;-<span class="cf">function</span>(dt){</span>
<span id="cb51-4"><a href="#cb51-4"></a>  n=<span class="kw">nrow</span>(dt)</span>
<span id="cb51-5"><a href="#cb51-5"></a>  c=<span class="kw">ncol</span>(dt)</span>
<span id="cb51-6"><a href="#cb51-6"></a>  central=dt</span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</span>
<span id="cb51-8"><a href="#cb51-8"></a>    central[,i]&lt;-dt[,i]<span class="op">-</span><span class="kw">mean</span>(dt[,i])</span>
<span id="cb51-9"><a href="#cb51-9"></a>  }</span>
<span id="cb51-10"><a href="#cb51-10"></a>  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</span>
<span id="cb51-11"><a href="#cb51-11"></a>  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</span>
<span id="cb51-12"><a href="#cb51-12"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</span>
<span id="cb51-13"><a href="#cb51-13"></a>  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></span>
<span id="cb51-14"><a href="#cb51-14"></a>  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb51-15"><a href="#cb51-15"></a>  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</span>
<span id="cb51-16"><a href="#cb51-16"></a>}</span>
<span id="cb51-17"><a href="#cb51-17"></a></span>
<span id="cb51-18"><a href="#cb51-18"></a><span class="kw">set.seed</span>(<span class="dv">54867</span>)</span>
<span id="cb51-19"><a href="#cb51-19"></a>mu=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb51-20"><a href="#cb51-20"></a>sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb51-21"><a href="#cb51-21"></a>m=<span class="dv">1000</span></span>
<span id="cb51-22"><a href="#cb51-22"></a>n=<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb51-23"><a href="#cb51-23"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb51-24"><a href="#cb51-24"></a>a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb51-25"><a href="#cb51-25"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb51-26"><a href="#cb51-26"></a>  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb51-27"><a href="#cb51-27"></a>    dt=<span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb51-28"><a href="#cb51-28"></a>    <span class="kw">skw</span>(dt)</span>
<span id="cb51-29"><a href="#cb51-29"></a>  }))</span>
<span id="cb51-30"><a href="#cb51-30"></a>}</span>
<span id="cb51-31"><a href="#cb51-31"></a>a</span></code></pre></div>
<pre><code>## [1] 0.000 0.013 0.023 0.043 0.044 0.043</code></pre>
<p>Some of the results are bigger than alpha. We can find that with bigger sample size, the result of the test will be better. Small sample size may leads to inaccurate value.</p>
<p>Example 6.10</p>
<p>Choose <span class="math inline">\(d=2\)</span> and calculate the power with different <span class="math inline">\(\epsilon\)</span> The contaminated multivariate normal distribution is denoted by: <span class="math display">\[(1-\epsilon)N((0,0)^T,I_2)+\epsilon N((0,0)^T,100I_2),0\le \epsilon \le 1\]</span> In this case the significance level <span class="math inline">\(\alpha=0.1\)</span> and the sample size <span class="math inline">\(n=30\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>msk=<span class="cf">function</span>(x){</span>
<span id="cb53-3"><a href="#cb53-3"></a>n=<span class="kw">nrow</span>(x)<span class="co">#sample size of x and y</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>d=<span class="kw">ncol</span>(x)</span>
<span id="cb53-5"><a href="#cb53-5"></a>sigma2=<span class="kw">cov</span>(x)<span class="co">#the MLE of the sample covariance</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>sigma=<span class="kw">solve</span>(sigma2)</span>
<span id="cb53-7"><a href="#cb53-7"></a>xbar=<span class="kw">apply</span>(x,<span class="dv">2</span>,mean)<span class="co">#average</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>xx=x<span class="op">-</span>xbar</span>
<span id="cb53-9"><a href="#cb53-9"></a>sum=<span class="dv">0</span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb53-11"><a href="#cb53-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb53-12"><a href="#cb53-12"></a>sum=sum<span class="op">+</span>(<span class="kw">t</span>(xx[i,])<span class="op">%*%</span>sigma<span class="op">%*%</span>(xx[j,]))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb53-13"><a href="#cb53-13"></a>  }</span>
<span id="cb53-14"><a href="#cb53-14"></a>}</span>
<span id="cb53-15"><a href="#cb53-15"></a>sk=sum<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb53-16"><a href="#cb53-16"></a><span class="kw">return</span>(sk)  </span>
<span id="cb53-17"><a href="#cb53-17"></a>}</span>
<span id="cb53-18"><a href="#cb53-18"></a></span>
<span id="cb53-19"><a href="#cb53-19"></a><span class="co">####main function</span></span>
<span id="cb53-20"><a href="#cb53-20"></a><span class="kw">library</span>(MASS)</span>
<span id="cb53-21"><a href="#cb53-21"></a>n=<span class="dv">30</span><span class="co">#sample size</span></span>
<span id="cb53-22"><a href="#cb53-22"></a>m=<span class="dv">100</span></span>
<span id="cb53-23"><a href="#cb53-23"></a>alpha=<span class="fl">0.1</span></span>
<span id="cb53-24"><a href="#cb53-24"></a>d=<span class="dv">2</span></span>
<span id="cb53-25"><a href="#cb53-25"></a>eps=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb53-26"><a href="#cb53-26"></a>le=<span class="kw">length</span>(eps)</span>
<span id="cb53-27"><a href="#cb53-27"></a>result=<span class="kw">numeric</span>(le)<span class="co">#power</span></span>
<span id="cb53-28"><a href="#cb53-28"></a>temp=<span class="kw">numeric</span>(m)</span>
<span id="cb53-29"><a href="#cb53-29"></a>x=<span class="kw">matrix</span>(<span class="dt">nrow=</span>n,<span class="dt">ncol=</span>d)</span>
<span id="cb53-30"><a href="#cb53-30"></a>free=d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span><span class="co">#degrees of freedom</span></span>
<span id="cb53-31"><a href="#cb53-31"></a>reject=<span class="dv">6</span><span class="op">*</span><span class="kw">qchisq</span>(.<span class="dv">975</span>,free)<span class="op">/</span>n</span>
<span id="cb53-32"><a href="#cb53-32"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>le){</span>
<span id="cb53-33"><a href="#cb53-33"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb53-34"><a href="#cb53-34"></a>sigma=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb53-35"><a href="#cb53-35"></a><span class="dt">size =</span>n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>eps[i], eps[i]))<span class="co">#replacement sampling to produce random vector</span></span>
<span id="cb53-36"><a href="#cb53-36"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb53-37"><a href="#cb53-37"></a>{x[k,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">numeric</span>(d), sigma[k]<span class="op">*</span><span class="kw">diag</span>(d))}</span>
<span id="cb53-38"><a href="#cb53-38"></a>temp[j]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">msk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>reject)</span>
<span id="cb53-39"><a href="#cb53-39"></a>}</span>
<span id="cb53-40"><a href="#cb53-40"></a>result[i]=<span class="kw">mean</span>(temp) <span class="co">#save the power of different epsilon </span></span>
<span id="cb53-41"><a href="#cb53-41"></a>}</span>
<span id="cb53-42"><a href="#cb53-42"></a><span class="kw">print</span>(result)</span></code></pre></div>
<pre><code>##  [1] 0.13 0.39 0.53 0.62 0.76 0.84 0.85 0.86 0.95 0.90 0.94 0.91 0.94 0.97 0.98
## [16] 0.95 0.95 0.99 0.95 0.93 0.87 0.82 0.76 0.58 0.57 0.48 0.42 0.34 0.26 0.28
## [31] 0.23 0.22 0.12 0.10</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co">######plot the figure#####</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>))</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="kw">plot</span>(eps, result, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(eps), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb55-6"><a href="#cb55-6"></a>sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(result <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>result) <span class="op">/</span><span class="st"> </span>m) <span class="co">#figure out the sd</span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="kw">lines</span>(eps, result<span class="op">+</span>sd, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="kw">lines</span>(eps, result<span class="op">-</span>sd, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the result and the figure we can easily find that when the epsilon value is close to 0 or 1, the empirical power is close to 0.1. Also, the power is close to 1 when epsilon is about 0.2. As epsilon value increasing, the empirical power increases steadily and decreases slowly.</p>
</div>
<div id="question-4-2" class="section level2">
<h2>Question 4</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t-test or McNemar test?</p>
<p>What information is needed to test your hypothesis?</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>Define: <span class="math inline">\(p_1\)</span>: the power of the first method; <span class="math inline">\(p_2\)</span>: the power of the second method</p>
<p>Thus the corresponding hypotheses test problem are :</p>
<p><span class="math inline">\(H_0:p_1=p_2\)</span> vs <span class="math inline">\(H_1:p_1\ne p_2\)</span></p>
<p>We can use Z-test, paired-t-test or McNemar test. We cannot use two-sample t-test because this method has independence requirement.</p>
<p>To test this hypothesis, as the significance level <span class="math inline">\(\alpha=0.05\)</span> is defined, we need to define a test statistic <span class="math inline">\(T\)</span>. Thus, the observe value of the test statistic <span class="math inline">\(T^*\)</span> can be figure out and we can calculate p-value. If <span class="math inline">\(p&lt;\alpha\)</span>, reject <span class="math inline">\(H_0\)</span>. If <span class="math inline">\(\alpha\le p\)</span>, we cannot reject <span class="math inline">\(H_0\)</span>.</p>
</div>
<div id="homework-2020-11-03" class="section level2">
<h2>Homework-2020-11-03</h2>
</div>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<p>An unbiased estimate of the bias of <span class="math inline">\(E(\hat{\theta})-\theta_0\)</span> is: <span class="math display">\[bias_{jack}=(n-1)(\bar{\hat{\theta}_{(·)}}-\hat{\theta})\]</span> An unbiased estimate of <span class="math inline">\(se(\hat{\theta})\)</span> is: <span class="math display">\[\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^n(\hat{\theta}_{(i)}-\bar{\hat{\theta}_{(·)}})^2}\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(bootstrap) </span></code></pre></div>
<pre><code>## Warning: package &#39;bootstrap&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>data1=<span class="kw">as.matrix</span>(law)</span>
<span id="cb58-2"><a href="#cb58-2"></a>cor_sample=<span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="kw">print</span>(cor_sample)<span class="co">#sample correlation</span></span></code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>sample_size=<span class="kw">nrow</span>(data1)<span class="co">#sample size</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>cor_jack=<span class="kw">numeric</span>(sample_size)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>sample_size){</span>
<span id="cb60-4"><a href="#cb60-4"></a>cor_jack[i]=<span class="kw">cor</span>(data1[<span class="op">-</span>i,<span class="dv">1</span>],data1[<span class="op">-</span>i,<span class="dv">2</span>])  </span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="co">#calculate each correlation  </span></span>
<span id="cb60-6"><a href="#cb60-6"></a>}</span>
<span id="cb60-7"><a href="#cb60-7"></a>jbias=(sample_size<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(cor_jack)<span class="op">-</span>cor_sample)</span>
<span id="cb60-8"><a href="#cb60-8"></a>jse=<span class="kw">sqrt</span>((sample_size<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((cor_jack<span class="op">-</span>cor_sample)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias_jack=</span>jbias,<span class="dt">se_jack=</span>jse),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## bias_jack   se_jack 
##   -0.0065    0.1425</code></pre>
<p>From the result we can see that, the jackknife estimate of the bias is -0.0065, the estimate of the standard error is 0.1425.</p>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<p>The pdf of the exponential model is: <span class="math inline">\(f(x)=\lambda e^{-\lambda x}I_{[x&gt;0]}\)</span>.</p>
<p>The loglikelihood function is: <span class="math inline">\(logL(x)=nln\lambda-\lambda\sum_{i=1}^nx_i\)</span>.</p>
<p>Thus, figure out the MSE of the parameter <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1/\bar{x}\)</span>.</p>
<p>And the MSE of <span class="math inline">\(1/\lambda\)</span> is <span class="math inline">\(1/\hat{\lambda}=\bar{x}\)</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb65-2"><a href="#cb65-2"></a>data2=<span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="co">#define a function to calculate the mean of the sample</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>bootbar=<span class="cf">function</span>(x,i){</span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="kw">mean</span>(x[i])</span>
<span id="cb65-6"><a href="#cb65-6"></a>} </span>
<span id="cb65-7"><a href="#cb65-7"></a>size=<span class="kw">nrow</span>(data2)<span class="co">#sample size</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>result=<span class="kw">boot</span>(data2, <span class="dt">statistic =</span>bootbar, <span class="dt">R=</span><span class="dv">1000</span>)</span>
<span id="cb65-9"><a href="#cb65-9"></a>result</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data2, statistic = bootbar, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original   bias    std. error
## t1* 108.0833 -0.83625    37.21426</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co">#figure out different bootstrap intervals</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw">boot.ci</span>(result, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = result, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 36.0, 181.9 )   ( 21.3, 171.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.5, 194.8 )   ( 59.3, 222.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>From the result, we can see that these four confidence intervals are different from each other while the length them are close to each other.</p>
<p>The normal bootstrap confidence level uses the Central Limit Theorem. However the distribution maybe not normal, and this method is not accurate as a result. As a consequence, it may look different with other intervals.</p>
<p>The basic bootstrap confidence interval transforms the distribution of the replicates by subtracting the observed statistic. The quantiles of the transformed sample are used to determine the confidence limits.</p>
<p>The bootstrap percentile interval uses the quantiles of the empirical distribution to estimate the quantiles of the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span>. This method works better when the distribution of <span class="math inline">\(\hat{\theta}\)</span> is not normal.</p>
<p>For a BCa intercal, the usual <span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1-\alpha/2\)</span> quantiles are adjusted by two factors: a correction for bias and a correction for skewness. So it could be more accurate than the bootstrap percentile interval.</p>
</div>
<div id="question-3-5" class="section level2">
<h2>Question 3</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3</h2>
<p>An unbiased estimate of the bias of <span class="math inline">\(E(\hat{\theta})-\theta_0\)</span> is: <span class="math display">\[bias_{jack}=(n-1)(\bar{\hat{\theta}_{(·)}}-\hat{\theta})\]</span> An unbiased estimate of <span class="math inline">\(se(\hat{\theta})\)</span> is: <span class="math display">\[\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^n(\hat{\theta}_{(i)}-\bar{\hat{\theta}_{(·)}})^2}\]</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb69-2"><a href="#cb69-2"></a>Sigmahat=<span class="kw">cov</span>(scor);</span>
<span id="cb69-3"><a href="#cb69-3"></a>n=<span class="kw">nrow</span>(scor)<span class="co">#sample size</span></span>
<span id="cb69-4"><a href="#cb69-4"></a>ev1=<span class="kw">eigen</span>(Sigmahat)</span>
<span id="cb69-5"><a href="#cb69-5"></a>thetahat=ev1<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(ev1<span class="op">$</span>values)</span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">thetahat=</span>thetahat),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## thetahat 
##   0.6191</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">#jackknife</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>thetajack=<span class="kw">numeric</span>(n)</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb71-4"><a href="#cb71-4"></a>Sigmajack=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])<span class="co">#calculate the sample cov</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>evjack=<span class="kw">eigen</span>(Sigmajack)</span>
<span id="cb71-6"><a href="#cb71-6"></a>thetajack[i]=evjack<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(evjack<span class="op">$</span>values)</span>
<span id="cb71-7"><a href="#cb71-7"></a>biasjack=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(thetajack)<span class="op">-</span>thetahat)}<span class="co">#jackknife bias</span></span>
<span id="cb71-8"><a href="#cb71-8"></a>sejack=<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((thetajack<span class="op">-</span><span class="kw">mean</span>(thetajack))<span class="op">^</span><span class="dv">2</span>))<span class="co">#jackknife se</span></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">jackknife_bias=</span>biasjack,<span class="dt">jackknife_se=</span>sejack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## jackknife_bias   jackknife_se 
##         0.0011         0.0496</code></pre>
<p>From the result we can see that, the jackknife estimate of the bias is 0.0011, the estimate of the standard error is 0.0496.</p>
</div>
<div id="question-4-3" class="section level2">
<h2>Question 4</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<p>Use leave-two-out cross validation to find the best model. While the sample size is n, choose (n-2) sample for fitting and 2 sample for testing.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: package &#39;DAAG&#39; was built under R version 4.0.3</code></pre>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb77-2"><a href="#cb77-2"></a>dt=ironslag</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="co">#leave-two-out cross validation</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>n=<span class="kw">length</span>(dt<span class="op">$</span>magnetic)</span>
<span id="cb77-5"><a href="#cb77-5"></a>err1=err2=err3=err4=<span class="kw">matrix</span>(<span class="dt">nrow=</span>n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb77-6"><a href="#cb77-6"></a>k=<span class="dv">1</span>;<span class="co">#save error</span></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){<span class="co">#choose the first test sample</span></span>
<span id="cb77-8"><a href="#cb77-8"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){<span class="co">#choose the second test sample</span></span>
<span id="cb77-9"><a href="#cb77-9"></a>    sp1=dt<span class="op">$</span>magnetic[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb77-10"><a href="#cb77-10"></a>    sp2=dt<span class="op">$</span>chemical[<span class="kw">c</span>(<span class="op">-</span>i,<span class="op">-</span>j)]</span>
<span id="cb77-11"><a href="#cb77-11"></a>    <span class="co">#Linear</span></span>
<span id="cb77-12"><a href="#cb77-12"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(sp1 <span class="op">~</span><span class="st"> </span>sp2)</span>
<span id="cb77-13"><a href="#cb77-13"></a>   j11 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[i]</span>
<span id="cb77-14"><a href="#cb77-14"></a>   j12 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[j]</span>
<span id="cb77-15"><a href="#cb77-15"></a>    err1[k,<span class="dv">1</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>j11</span>
<span id="cb77-16"><a href="#cb77-16"></a>    err1[k,<span class="dv">2</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>j12</span>
<span id="cb77-17"><a href="#cb77-17"></a>    <span class="co"># Quadratic</span></span>
<span id="cb77-18"><a href="#cb77-18"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(sp1 <span class="op">~</span><span class="st"> </span>sp2 <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(sp2<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb77-19"><a href="#cb77-19"></a>    j21 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[i] <span class="op">+</span></span>
<span id="cb77-20"><a href="#cb77-20"></a><span class="st">      </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb77-21"><a href="#cb77-21"></a>    j22 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[j] <span class="op">+</span></span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="st">      </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb77-23"><a href="#cb77-23"></a>    err2[k,<span class="dv">1</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>j21</span>
<span id="cb77-24"><a href="#cb77-24"></a>    err2[k,<span class="dv">2</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>j22</span>
<span id="cb77-25"><a href="#cb77-25"></a>    <span class="co">#Exponential</span></span>
<span id="cb77-26"><a href="#cb77-26"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(sp1) <span class="op">~</span><span class="st"> </span>sp2)</span>
<span id="cb77-27"><a href="#cb77-27"></a>    j31 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[i]</span>
<span id="cb77-28"><a href="#cb77-28"></a>    j31 &lt;-<span class="st"> </span><span class="kw">exp</span>(j31)</span>
<span id="cb77-29"><a href="#cb77-29"></a>    j32 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>dt<span class="op">$</span>chemical[j]</span>
<span id="cb77-30"><a href="#cb77-30"></a>    j32 &lt;-<span class="st"> </span><span class="kw">exp</span>(j32)</span>
<span id="cb77-31"><a href="#cb77-31"></a>    err3[k,<span class="dv">1</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>j31</span>
<span id="cb77-32"><a href="#cb77-32"></a>    err3[k,<span class="dv">2</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>j32</span>
<span id="cb77-33"><a href="#cb77-33"></a>    <span class="co">#Log-Log</span></span>
<span id="cb77-34"><a href="#cb77-34"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(sp1) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(sp2))</span>
<span id="cb77-35"><a href="#cb77-35"></a>    j41 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(dt<span class="op">$</span>chemical[i])</span>
<span id="cb77-36"><a href="#cb77-36"></a>    j41 &lt;-<span class="st"> </span><span class="kw">exp</span>(j41)</span>
<span id="cb77-37"><a href="#cb77-37"></a>    j42 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(dt<span class="op">$</span>chemical[j])</span>
<span id="cb77-38"><a href="#cb77-38"></a>    j42 &lt;-<span class="st"> </span><span class="kw">exp</span>(j42)</span>
<span id="cb77-39"><a href="#cb77-39"></a>    err4[k,<span class="dv">1</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[i] <span class="op">-</span><span class="st"> </span>j41</span>
<span id="cb77-40"><a href="#cb77-40"></a>    err4[k,<span class="dv">2</span>] &lt;-<span class="st"> </span>dt<span class="op">$</span>magnetic[j] <span class="op">-</span><span class="st"> </span>j42</span>
<span id="cb77-41"><a href="#cb77-41"></a>    </span>
<span id="cb77-42"><a href="#cb77-42"></a>    k=k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb77-43"><a href="#cb77-43"></a>  }</span>
<span id="cb77-44"><a href="#cb77-44"></a>}</span>
<span id="cb77-45"><a href="#cb77-45"></a></span>
<span id="cb77-46"><a href="#cb77-46"></a><span class="co">#estimate the prediction error</span></span>
<span id="cb77-47"><a href="#cb77-47"></a><span class="kw">c</span>(<span class="kw">mean</span>(err1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(err2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(err3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(err4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the regression equation, the quadratic model may be the best fit for the data with least error. This result is the same with the result in leave-oue-out cross validation.</p>
</div>
<div id="homework-2020-11-10" class="section level2">
<h2>Homework-2020-11-10</h2>
</div>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<p>Use permutation test to solve this problem. Count the extreme number in the original sample and compare the number with that in permutation vector. Set the sample size <span class="math inline">\(n_1=20\)</span>, <span class="math inline">\(n_2=30\)</span>. Generate sample <span class="math inline">\(X \sim N(0,1)\)</span> and <span class="math inline">\(Y \sim N(0,1)\)</span>. Calculate the p-value.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>count5test =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb79-2"><a href="#cb79-2"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb79-3"><a href="#cb79-3"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-4"><a href="#cb79-4"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb79-5"><a href="#cb79-5"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb79-6"><a href="#cb79-6"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb79-8"><a href="#cb79-8"></a>}</span>
<span id="cb79-9"><a href="#cb79-9"></a></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="co"># Count Five test permutation</span></span>
<span id="cb79-11"><a href="#cb79-11"></a>c5p=<span class="st"> </span><span class="cf">function</span>(z) {</span>
<span id="cb79-12"><a href="#cb79-12"></a>n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb79-13"><a href="#cb79-13"></a>x =<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb79-14"><a href="#cb79-14"></a>y =<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))]</span>
<span id="cb79-15"><a href="#cb79-15"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb79-16"><a href="#cb79-16"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-17"><a href="#cb79-17"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </span>
<span id="cb79-18"><a href="#cb79-18"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb79-19"><a href="#cb79-19"></a><span class="co"># return 1 (reject) or 0 (do not reject H0) </span></span>
<span id="cb79-20"><a href="#cb79-20"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb79-21"><a href="#cb79-21"></a>}</span>
<span id="cb79-22"><a href="#cb79-22"></a>permutation =<span class="st"> </span><span class="cf">function</span>(z,R) {</span>
<span id="cb79-23"><a href="#cb79-23"></a>  n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb79-24"><a href="#cb79-24"></a>  out =<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb79-25"><a href="#cb79-25"></a>  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>R){</span>
<span id="cb79-26"><a href="#cb79-26"></a>      p =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n ,n ,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb79-27"><a href="#cb79-27"></a>      out[r] =<span class="st"> </span><span class="kw">c5p</span>(z[p])</span>
<span id="cb79-28"><a href="#cb79-28"></a>  }</span>
<span id="cb79-29"><a href="#cb79-29"></a>  <span class="kw">sum</span>(out)<span class="op">/</span>R</span>
<span id="cb79-30"><a href="#cb79-30"></a>}              </span>
<span id="cb79-31"><a href="#cb79-31"></a><span class="co">#main</span></span>
<span id="cb79-32"><a href="#cb79-32"></a>n1 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb79-33"><a href="#cb79-33"></a>n2 =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb79-34"><a href="#cb79-34"></a>mu1 =<span class="st"> </span>mu2 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb79-35"><a href="#cb79-35"></a>sigma1 =<span class="st"> </span>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb79-36"><a href="#cb79-36"></a>m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb79-37"><a href="#cb79-37"></a>alphahat1 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb79-38"><a href="#cb79-38"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb79-39"><a href="#cb79-39"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb79-40"><a href="#cb79-40"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb79-41"><a href="#cb79-41"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-42"><a href="#cb79-42"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb79-43"><a href="#cb79-43"></a>}))</span>
<span id="cb79-44"><a href="#cb79-44"></a>alphahat2 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb79-45"><a href="#cb79-45"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb79-46"><a href="#cb79-46"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb79-47"><a href="#cb79-47"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean </span></span>
<span id="cb79-48"><a href="#cb79-48"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb79-49"><a href="#cb79-49"></a>z =<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb79-50"><a href="#cb79-50"></a><span class="kw">permutation</span>(z,<span class="dv">1000</span>) </span>
<span id="cb79-51"><a href="#cb79-51"></a>})<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb79-52"><a href="#cb79-52"></a></span>
<span id="cb79-53"><a href="#cb79-53"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">count5test=</span>alphahat1,<span class="dt">count5test_permutation=</span>alphahat2),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##             count5test count5test_permutation 
##                  0.293                  0.041</code></pre>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ol>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\sigma_1 \neq\sigma_2，\mu_1=\mu_2\)</span></li>
</ol>
<p>The dimension of the sample is 2. Generate sample <span class="math inline">\(X,Y\)</span> from normal distribution, and the sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 30 and 30.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: package &#39;Ball&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: package &#39;RANN&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: package &#39;energy&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="co">#def stat function</span></span>
<span id="cb87-3"><a href="#cb87-3"></a>stat=<span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb87-4"><a href="#cb87-4"></a>  n1=sizes[<span class="dv">1</span>]; n2=sizes[<span class="dv">2</span>]; n=n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb87-5"><a href="#cb87-5"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z=<span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb87-6"><a href="#cb87-6"></a>  z=z[ix, ];</span>
<span id="cb87-7"><a href="#cb87-7"></a>  NN=<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb87-8"><a href="#cb87-8"></a>  tp1=NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb87-9"><a href="#cb87-9"></a>  tp2=NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb87-10"><a href="#cb87-10"></a>  i1=<span class="kw">sum</span>(tp1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2=<span class="st"> </span><span class="kw">sum</span>(tp2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb87-11"><a href="#cb87-11"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb87-12"><a href="#cb87-12"></a>} </span>
<span id="cb87-13"><a href="#cb87-13"></a><span class="co">#def knn funcion</span></span>
<span id="cb87-14"><a href="#cb87-14"></a>eqdist.nn=<span class="cf">function</span>(z,sizes,k,R){</span>
<span id="cb87-15"><a href="#cb87-15"></a>  boot.obj=<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>stat,<span class="dt">R=</span>R,</span>
<span id="cb87-16"><a href="#cb87-16"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb87-17"><a href="#cb87-17"></a>  ts=<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb87-18"><a href="#cb87-18"></a>  p.value=<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb87-19"><a href="#cb87-19"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb87-20"><a href="#cb87-20"></a>} </span>
<span id="cb87-21"><a href="#cb87-21"></a><span class="co">#####simulation##### </span></span>
<span id="cb87-22"><a href="#cb87-22"></a>m=<span class="dv">200</span>;</span>
<span id="cb87-23"><a href="#cb87-23"></a>knn=<span class="dv">3</span>; </span>
<span id="cb87-24"><a href="#cb87-24"></a>di=<span class="dv">2</span>; <span class="co">#dimension</span></span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb87-26"><a href="#cb87-26"></a>n1=<span class="dv">30</span></span>
<span id="cb87-27"><a href="#cb87-27"></a>n2=<span class="dv">30</span>; </span>
<span id="cb87-28"><a href="#cb87-28"></a>R=<span class="dv">999</span>; </span>
<span id="cb87-29"><a href="#cb87-29"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb87-30"><a href="#cb87-30"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb87-31"><a href="#cb87-31"></a><span class="co">#save p-value</span></span>
<span id="cb87-32"><a href="#cb87-32"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb87-33"><a href="#cb87-33"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb87-34"><a href="#cb87-34"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb87-35"><a href="#cb87-35"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2));</span>
<span id="cb87-36"><a href="#cb87-36"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb87-37"><a href="#cb87-37"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb87-38"><a href="#cb87-38"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb87-39"><a href="#cb87-39"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb87-40"><a href="#cb87-40"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb87-41"><a href="#cb87-41"></a>} </span>
<span id="cb87-42"><a href="#cb87-42"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb87-43"><a href="#cb87-43"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb87-44"><a href="#cb87-44"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb87-45"><a href="#cb87-45"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.355  0.390  0.775</code></pre>
<p>When demension=1, choose <span class="math inline">\(X \sim N(0,2^2),Y \sim N(0,1)\)</span>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>m=<span class="dv">200</span>;</span>
<span id="cb89-2"><a href="#cb89-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb89-3"><a href="#cb89-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb89-5"><a href="#cb89-5"></a>n1=<span class="dv">30</span></span>
<span id="cb89-6"><a href="#cb89-6"></a>n2=<span class="dv">30</span>; </span>
<span id="cb89-7"><a href="#cb89-7"></a>R=<span class="dv">999</span>; </span>
<span id="cb89-8"><a href="#cb89-8"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb89-9"><a href="#cb89-9"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="co">#save p-value</span></span>
<span id="cb89-11"><a href="#cb89-11"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb89-13"><a href="#cb89-13"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb89-14"><a href="#cb89-14"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2));</span>
<span id="cb89-15"><a href="#cb89-15"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb89-16"><a href="#cb89-16"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb89-17"><a href="#cb89-17"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb89-18"><a href="#cb89-18"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb89-19"><a href="#cb89-19"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb89-20"><a href="#cb89-20"></a>} </span>
<span id="cb89-21"><a href="#cb89-21"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb89-22"><a href="#cb89-22"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb89-23"><a href="#cb89-23"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb89-24"><a href="#cb89-24"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.525  0.600  0.820</code></pre>
<p>From the result we can see that with unequal variances and equal expectations. Ball may be more powerful for non-location family distribution. In addition, those tests are more effective for multivariates. The power of ball with three dimension is close to 1. However, the other tests are less powerful.</p>
<p>(2)<span class="math inline">\(\sigma_1 \neq \sigma_2，\mu_1\neq\mu_2\)</span></p>
<p>The dimension of the sample is 2. Generate sample <span class="math inline">\(X,Y\)</span> from normal distribution and the sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 30 and 30.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="co">#####simulation##### </span></span>
<span id="cb91-2"><a href="#cb91-2"></a>m=<span class="dv">200</span>;</span>
<span id="cb91-3"><a href="#cb91-3"></a>knn=<span class="dv">3</span>; </span>
<span id="cb91-4"><a href="#cb91-4"></a>di=<span class="dv">2</span>; <span class="co">#dimension</span></span>
<span id="cb91-5"><a href="#cb91-5"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb91-6"><a href="#cb91-6"></a>n1=<span class="dv">30</span></span>
<span id="cb91-7"><a href="#cb91-7"></a>n2=<span class="dv">30</span>; </span>
<span id="cb91-8"><a href="#cb91-8"></a>R=<span class="dv">999</span>; </span>
<span id="cb91-9"><a href="#cb91-9"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb91-10"><a href="#cb91-10"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb91-11"><a href="#cb91-11"></a><span class="co">#save p-value</span></span>
<span id="cb91-12"><a href="#cb91-12"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb91-13"><a href="#cb91-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb91-14"><a href="#cb91-14"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb91-15"><a href="#cb91-15"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>));</span>
<span id="cb91-16"><a href="#cb91-16"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb91-17"><a href="#cb91-17"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb91-18"><a href="#cb91-18"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb91-19"><a href="#cb91-19"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb91-20"><a href="#cb91-20"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb91-21"><a href="#cb91-21"></a>} </span>
<span id="cb91-22"><a href="#cb91-22"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb91-23"><a href="#cb91-23"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb91-24"><a href="#cb91-24"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb91-25"><a href="#cb91-25"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.575  0.785  0.925</code></pre>
<p>When demension=1: choose <span class="math inline">\(X \sim N(-0.5,2^2),Y \sim N(0,1)\)</span>:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>m=<span class="dv">200</span>;</span>
<span id="cb93-2"><a href="#cb93-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb93-3"><a href="#cb93-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb93-5"><a href="#cb93-5"></a>n1=<span class="dv">30</span></span>
<span id="cb93-6"><a href="#cb93-6"></a>n2=<span class="dv">30</span>; </span>
<span id="cb93-7"><a href="#cb93-7"></a>R=<span class="dv">999</span>; </span>
<span id="cb93-8"><a href="#cb93-8"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb93-9"><a href="#cb93-9"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb93-10"><a href="#cb93-10"></a><span class="co">#save p-value</span></span>
<span id="cb93-11"><a href="#cb93-11"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb93-12"><a href="#cb93-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb93-13"><a href="#cb93-13"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb93-14"><a href="#cb93-14"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>));</span>
<span id="cb93-15"><a href="#cb93-15"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb93-16"><a href="#cb93-16"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb93-17"><a href="#cb93-17"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb93-18"><a href="#cb93-18"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb93-19"><a href="#cb93-19"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb93-20"><a href="#cb93-20"></a>} </span>
<span id="cb93-21"><a href="#cb93-21"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb93-22"><a href="#cb93-22"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb93-23"><a href="#cb93-23"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb93-24"><a href="#cb93-24"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.515  0.780  0.875</code></pre>
<p>From the result we can see that with unequal variances and unequal expectations. First, we choose sample with 3 dimension. Ball is still more powerful than other two tests, the power of which is close to 1. In addition, in this test energy test performs better than NN test. However, if we enlarge the difference between variances and expectations, those three tests will all perform well with power almost to 1. When the difference is small, ball works better.</p>
<p>When the sample dimension is 1, those tests may not be as effective as before. Maybe they just perform well for multivariate tests. Also, in this case, NN test has the lowest power.</p>
<ol start="3" style="list-style-type: decimal">
<li>t distribution</li>
</ol>
<p>Choose <span class="math inline">\(X \sim t(1), Y\sim t(10)\)</span>, the sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 30 and 30:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="co">###########t-distribution###########</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>m=<span class="dv">200</span>;</span>
<span id="cb95-3"><a href="#cb95-3"></a>knn=<span class="dv">3</span>; </span>
<span id="cb95-4"><a href="#cb95-4"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb95-5"><a href="#cb95-5"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb95-6"><a href="#cb95-6"></a>n1=<span class="dv">30</span></span>
<span id="cb95-7"><a href="#cb95-7"></a>n2=<span class="dv">30</span>; </span>
<span id="cb95-8"><a href="#cb95-8"></a>R=<span class="dv">999</span>; </span>
<span id="cb95-9"><a href="#cb95-9"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb95-10"><a href="#cb95-10"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb95-11"><a href="#cb95-11"></a><span class="co">#save p-value</span></span>
<span id="cb95-12"><a href="#cb95-12"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb95-13"><a href="#cb95-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb95-14"><a href="#cb95-14"></a>  x=<span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>di,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb95-15"><a href="#cb95-15"></a>  y=<span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">10</span>));</span>
<span id="cb95-16"><a href="#cb95-16"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb95-17"><a href="#cb95-17"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb95-18"><a href="#cb95-18"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb95-19"><a href="#cb95-19"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb95-20"><a href="#cb95-20"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb95-21"><a href="#cb95-21"></a>} </span>
<span id="cb95-22"><a href="#cb95-22"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb95-23"><a href="#cb95-23"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb95-24"><a href="#cb95-24"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb95-25"><a href="#cb95-25"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>) </span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.305  0.610  0.565</code></pre>
<p>Choose <span class="math inline">\(X \sim t(1), Y\sim N(0,1)\)</span>:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>m=<span class="dv">200</span>;</span>
<span id="cb97-2"><a href="#cb97-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb97-3"><a href="#cb97-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb97-4"><a href="#cb97-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb97-5"><a href="#cb97-5"></a>n1=<span class="dv">30</span></span>
<span id="cb97-6"><a href="#cb97-6"></a>n2=<span class="dv">30</span>; </span>
<span id="cb97-7"><a href="#cb97-7"></a>R=<span class="dv">999</span>; </span>
<span id="cb97-8"><a href="#cb97-8"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb97-9"><a href="#cb97-9"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb97-10"><a href="#cb97-10"></a><span class="co">#save p-value</span></span>
<span id="cb97-11"><a href="#cb97-11"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb97-12"><a href="#cb97-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb97-13"><a href="#cb97-13"></a>  x=<span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>di,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb97-14"><a href="#cb97-14"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2));</span>
<span id="cb97-15"><a href="#cb97-15"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb97-16"><a href="#cb97-16"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb97-17"><a href="#cb97-17"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb97-18"><a href="#cb97-18"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb97-19"><a href="#cb97-19"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb97-20"><a href="#cb97-20"></a>} </span>
<span id="cb97-21"><a href="#cb97-21"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb97-22"><a href="#cb97-22"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb97-23"><a href="#cb97-23"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb97-24"><a href="#cb97-24"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>) </span></code></pre></div>
<pre><code>##     nn energy   ball 
##   0.41   0.70   0.71</code></pre>
<p>It seems that in this case, energy and ball test performs better while NN test is less powerful.</p>
<p>bimodel distribution</p>
<p><span class="math inline">\(F_X=0.5 \phi(-1,1.5^2)+0.5 \phi(0,1),F_Y=0.5 \phi(-0.5,4^2)+0.5 \phi(1,2^2)\)</span></p>
<p><span class="math inline">\(\phi\)</span> is the cdf of normal distribution.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>m=<span class="dv">200</span>;</span>
<span id="cb99-2"><a href="#cb99-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb99-3"><a href="#cb99-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb99-5"><a href="#cb99-5"></a>n1=<span class="dv">30</span></span>
<span id="cb99-6"><a href="#cb99-6"></a>n2=<span class="dv">30</span>; </span>
<span id="cb99-7"><a href="#cb99-7"></a>R=<span class="dv">999</span>;</span>
<span id="cb99-8"><a href="#cb99-8"></a><span class="co">#bimodel distribution</span></span>
<span id="cb99-9"><a href="#cb99-9"></a>mu1=<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb99-10"><a href="#cb99-10"></a>sig1=<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb99-11"><a href="#cb99-11"></a>mu2=<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb99-12"><a href="#cb99-12"></a>sig2=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb99-13"><a href="#cb99-13"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb99-14"><a href="#cb99-14"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb99-15"><a href="#cb99-15"></a><span class="co">#save p-value</span></span>
<span id="cb99-16"><a href="#cb99-16"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb99-17"><a href="#cb99-17"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb99-18"><a href="#cb99-18"></a>  lab1=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb99-19"><a href="#cb99-19"></a>              <span class="dt">size =</span> n1, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb99-20"><a href="#cb99-20"></a>  lab2=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb99-21"><a href="#cb99-21"></a>              <span class="dt">size =</span> n2, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb99-22"><a href="#cb99-22"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,mu1[lab1],sig1[lab1]),<span class="dt">ncol=</span>di);</span>
<span id="cb99-23"><a href="#cb99-23"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,mu2[lab2],sig1[lab2]));</span>
<span id="cb99-24"><a href="#cb99-24"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb99-25"><a href="#cb99-25"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb99-26"><a href="#cb99-26"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb99-27"><a href="#cb99-27"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb99-28"><a href="#cb99-28"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb99-29"><a href="#cb99-29"></a>} </span>
<span id="cb99-30"><a href="#cb99-30"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb99-31"><a href="#cb99-31"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb99-32"><a href="#cb99-32"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb99-33"><a href="#cb99-33"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>) </span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.275  0.620  0.555</code></pre>
<p>In this case, the power of energy test seems higher than other tests. NN test does not work well with lowest power.</p>
<p>bimodel distribution vs t <span class="math inline">\(F_X=0.3 \phi(-1,1.5^2)+0.7 \phi(0,1),Y \sim t(1)\)</span></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>m=<span class="dv">100</span>;</span>
<span id="cb101-2"><a href="#cb101-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb101-3"><a href="#cb101-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb101-5"><a href="#cb101-5"></a>n1=<span class="dv">30</span></span>
<span id="cb101-6"><a href="#cb101-6"></a>n2=<span class="dv">30</span>; </span>
<span id="cb101-7"><a href="#cb101-7"></a>R=<span class="dv">999</span>;</span>
<span id="cb101-8"><a href="#cb101-8"></a>mu1=<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb101-9"><a href="#cb101-9"></a>sig1=<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb101-10"><a href="#cb101-10"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb101-11"><a href="#cb101-11"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb101-12"><a href="#cb101-12"></a><span class="co">#save p-value</span></span>
<span id="cb101-13"><a href="#cb101-13"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb101-14"><a href="#cb101-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb101-15"><a href="#cb101-15"></a>  lab1=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb101-16"><a href="#cb101-16"></a>              <span class="dt">size =</span> n1, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb101-17"><a href="#cb101-17"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,mu1[lab1],sig1[lab1]),<span class="dt">ncol=</span>di);</span>
<span id="cb101-18"><a href="#cb101-18"></a>  y=<span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dv">1</span>));</span>
<span id="cb101-19"><a href="#cb101-19"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb101-20"><a href="#cb101-20"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb101-21"><a href="#cb101-21"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb101-22"><a href="#cb101-22"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb101-23"><a href="#cb101-23"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb101-24"><a href="#cb101-24"></a>} </span>
<span id="cb101-25"><a href="#cb101-25"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb101-26"><a href="#cb101-26"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb101-27"><a href="#cb101-27"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb101-28"><a href="#cb101-28"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##   0.25   0.46   0.39</code></pre>
<p>In this case, I change the sample probability. The power of energy still performs better than other tests. Ball test is still powerful in this case. However, NN test may be far less powerful.</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls) Choose different sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</li>
</ol>
<p>Case 1: unequal expectations and variances:</p>
<p><span class="math inline">\(X \sim N(-0.5,1.5^2),Y \sim N(0,1)\)</span> and the sample size of <span class="math inline">\(X,Y\)</span> is 100 and 10.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>m=<span class="dv">200</span>;</span>
<span id="cb103-2"><a href="#cb103-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb103-3"><a href="#cb103-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb103-5"><a href="#cb103-5"></a>n1=<span class="dv">100</span></span>
<span id="cb103-6"><a href="#cb103-6"></a>n2=<span class="dv">10</span>; </span>
<span id="cb103-7"><a href="#cb103-7"></a>R=<span class="dv">999</span>; </span>
<span id="cb103-8"><a href="#cb103-8"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb103-9"><a href="#cb103-9"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb103-10"><a href="#cb103-10"></a><span class="co">#save p-value</span></span>
<span id="cb103-11"><a href="#cb103-11"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb103-12"><a href="#cb103-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb103-13"><a href="#cb103-13"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb103-14"><a href="#cb103-14"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>));</span>
<span id="cb103-15"><a href="#cb103-15"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb103-16"><a href="#cb103-16"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb103-17"><a href="#cb103-17"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb103-18"><a href="#cb103-18"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb103-19"><a href="#cb103-19"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb103-20"><a href="#cb103-20"></a>} </span>
<span id="cb103-21"><a href="#cb103-21"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb103-22"><a href="#cb103-22"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb103-23"><a href="#cb103-23"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb103-24"><a href="#cb103-24"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##   0.16   0.33   0.76</code></pre>
<p>In this case, we can see that the power of three test is lower than those with the same sample size. The NN test has the lowest power while the ball test is still very powerful.</p>
<p>Case 2: t-distribution:</p>
<p>Choose <span class="math inline">\(X \sim t(1), Y\sim t(10)\)</span>, the sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 100 and 10:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="co">###########t-distribution###########</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>m=<span class="dv">200</span>;</span>
<span id="cb105-3"><a href="#cb105-3"></a>knn=<span class="dv">3</span>; </span>
<span id="cb105-4"><a href="#cb105-4"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb105-5"><a href="#cb105-5"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb105-6"><a href="#cb105-6"></a>n1=<span class="dv">100</span></span>
<span id="cb105-7"><a href="#cb105-7"></a>n2=<span class="dv">10</span>; </span>
<span id="cb105-8"><a href="#cb105-8"></a>R=<span class="dv">999</span>; </span>
<span id="cb105-9"><a href="#cb105-9"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb105-10"><a href="#cb105-10"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb105-11"><a href="#cb105-11"></a><span class="co">#save p-value</span></span>
<span id="cb105-12"><a href="#cb105-12"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb105-13"><a href="#cb105-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb105-14"><a href="#cb105-14"></a>  x=<span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>di,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>di);</span>
<span id="cb105-15"><a href="#cb105-15"></a>  y=<span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">10</span>));</span>
<span id="cb105-16"><a href="#cb105-16"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb105-17"><a href="#cb105-17"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb105-18"><a href="#cb105-18"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb105-19"><a href="#cb105-19"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb105-20"><a href="#cb105-20"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb105-21"><a href="#cb105-21"></a>} </span>
<span id="cb105-22"><a href="#cb105-22"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb105-23"><a href="#cb105-23"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb105-24"><a href="#cb105-24"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb105-25"><a href="#cb105-25"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>) </span></code></pre></div>
<pre><code>##     nn energy   ball 
##  0.110  0.005  0.445</code></pre>
<p>It seems that the energy test performs worst with low power. The ball test still performs best.</p>
<p>Case 3: bimodel distribution</p>
<p><span class="math inline">\(F_X=0.3 \phi(-1,1.5)+0.7 \phi(0,1),F_Y=0.2 \phi(-0.5,4)+0.8 \phi(1,2)\)</span>, the sample size of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is 100 and 10:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>m=<span class="dv">100</span>;</span>
<span id="cb107-2"><a href="#cb107-2"></a>knn=<span class="dv">3</span>; </span>
<span id="cb107-3"><a href="#cb107-3"></a>di=<span class="dv">1</span>; <span class="co">#dimension</span></span>
<span id="cb107-4"><a href="#cb107-4"></a><span class="kw">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb107-5"><a href="#cb107-5"></a>n1=<span class="dv">100</span></span>
<span id="cb107-6"><a href="#cb107-6"></a>n2=<span class="dv">10</span>; </span>
<span id="cb107-7"><a href="#cb107-7"></a>R=<span class="dv">999</span>;</span>
<span id="cb107-8"><a href="#cb107-8"></a>mu1=<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb107-9"><a href="#cb107-9"></a>sig1=<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb107-10"><a href="#cb107-10"></a>mu2=<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb107-11"><a href="#cb107-11"></a>sig2=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb107-12"><a href="#cb107-12"></a>n=n1<span class="op">+</span>n2; </span>
<span id="cb107-13"><a href="#cb107-13"></a>N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb107-14"><a href="#cb107-14"></a><span class="co">#save p-value</span></span>
<span id="cb107-15"><a href="#cb107-15"></a>vp=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb107-16"><a href="#cb107-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb107-17"><a href="#cb107-17"></a>  lab1=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb107-18"><a href="#cb107-18"></a>              <span class="dt">size =</span> n1, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb107-19"><a href="#cb107-19"></a>  lab2=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb107-20"><a href="#cb107-20"></a>              <span class="dt">size =</span> n2, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span>
<span id="cb107-21"><a href="#cb107-21"></a>  x=<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>di,mu1[lab1],sig1[lab1]),<span class="dt">ncol=</span>di);</span>
<span id="cb107-22"><a href="#cb107-22"></a>  y=<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,mu2[lab2],sig1[lab2]));</span>
<span id="cb107-23"><a href="#cb107-23"></a>  z=<span class="kw">rbind</span>(x,y)</span>
<span id="cb107-24"><a href="#cb107-24"></a>  <span class="co">##knn, erergy, ball</span></span>
<span id="cb107-25"><a href="#cb107-25"></a>  vp[i,<span class="dv">1</span>]=<span class="kw">eqdist.nn</span>(z,N,knn,R)<span class="op">$</span>p.value</span>
<span id="cb107-26"><a href="#cb107-26"></a>  vp[i,<span class="dv">2</span>]=<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb107-27"><a href="#cb107-27"></a>  vp[i,<span class="dv">3</span>]=<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb107-28"><a href="#cb107-28"></a>} </span>
<span id="cb107-29"><a href="#cb107-29"></a>alpha=<span class="fl">0.1</span>;</span>
<span id="cb107-30"><a href="#cb107-30"></a>pwr1=<span class="kw">colMeans</span>(vp<span class="op">&lt;</span>alpha) <span class="co">#calculate power under 3 different tests</span></span>
<span id="cb107-31"><a href="#cb107-31"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">nn=</span>pwr1[<span class="dv">1</span>],<span class="dt">energy=</span>pwr1[<span class="dv">2</span>],</span>
<span id="cb107-32"><a href="#cb107-32"></a>        <span class="dt">ball=</span>pwr1[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     nn energy   ball 
##   0.32   0.78   0.63</code></pre>
<p>The result shows that with different sample size, the energy test still performs best with sample from bimodel distribution.</p>
</div>
<div id="homework-2020-11-17" class="section level2">
<h2>Homework-2020-11-17</h2>
</div>
<div id="question-1-7" class="section level2">
<h2>Question 1</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x \in R\)</span>.</p>
<p>The proposal distribution is normal distribution <span class="math inline">\(N(X_t,\sigma^2)\)</span>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co">#define a function to calculate the pdf of Laplace distribution</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>La=<span class="cf">function</span>(x){</span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb109-4"><a href="#cb109-4"></a>}</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="co">#define a function to generate the chain</span></span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="co">#x0: initial value;</span></span>
<span id="cb109-7"><a href="#cb109-7"></a><span class="co">#N: the length of the chain</span></span>
<span id="cb109-8"><a href="#cb109-8"></a>LRWM=<span class="cf">function</span>(sigma, x0, N) { </span>
<span id="cb109-9"><a href="#cb109-9"></a>x=<span class="kw">numeric</span>(N)</span>
<span id="cb109-10"><a href="#cb109-10"></a>x[<span class="dv">1</span>]=x0</span>
<span id="cb109-11"><a href="#cb109-11"></a>u=<span class="kw">runif</span>(N)</span>
<span id="cb109-12"><a href="#cb109-12"></a>acp=<span class="dv">0</span> <span class="co">#acceptance rate</span></span>
<span id="cb109-13"><a href="#cb109-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) { </span>
<span id="cb109-14"><a href="#cb109-14"></a>  y=<span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </span>
<span id="cb109-15"><a href="#cb109-15"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">La</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">La</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb109-16"><a href="#cb109-16"></a>  {x[i]=y</span>
<span id="cb109-17"><a href="#cb109-17"></a>   acp=acp<span class="op">+</span><span class="dv">1</span> </span>
<span id="cb109-18"><a href="#cb109-18"></a>   } </span>
<span id="cb109-19"><a href="#cb109-19"></a>  <span class="cf">else</span> {</span>
<span id="cb109-20"><a href="#cb109-20"></a>    x[i]=x[i<span class="dv">-1</span>] </span>
<span id="cb109-21"><a href="#cb109-21"></a>  } </span>
<span id="cb109-22"><a href="#cb109-22"></a>  }</span>
<span id="cb109-23"><a href="#cb109-23"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">acp=</span>acp)) </span>
<span id="cb109-24"><a href="#cb109-24"></a>}</span>
<span id="cb109-25"><a href="#cb109-25"></a>N=<span class="dv">2000</span></span>
<span id="cb109-26"><a href="#cb109-26"></a>sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">16</span>)</span>
<span id="cb109-27"><a href="#cb109-27"></a>x0=<span class="dv">0</span> </span>
<span id="cb109-28"><a href="#cb109-28"></a>rw1=<span class="kw">LRWM</span>(sigma[<span class="dv">1</span>], x0, N) </span>
<span id="cb109-29"><a href="#cb109-29"></a>rw2=<span class="kw">LRWM</span>(sigma[<span class="dv">2</span>], x0, N) </span>
<span id="cb109-30"><a href="#cb109-30"></a>rw3=<span class="kw">LRWM</span>(sigma[<span class="dv">3</span>], x0, N) </span>
<span id="cb109-31"><a href="#cb109-31"></a>rw4=<span class="kw">LRWM</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb109-32"><a href="#cb109-32"></a>rw5=<span class="kw">LRWM</span>(sigma[<span class="dv">5</span>], x0, N)</span>
<span id="cb109-33"><a href="#cb109-33"></a>rw6=<span class="kw">LRWM</span>(sigma[<span class="dv">6</span>], x0, N)</span>
<span id="cb109-34"><a href="#cb109-34"></a><span class="kw">round</span>(<span class="kw">c</span>(rw1<span class="op">$</span>acp<span class="op">/</span>N, rw2<span class="op">$</span>acp<span class="op">/</span>N, rw3<span class="op">$</span>acp<span class="op">/</span>N, rw4<span class="op">$</span>acp<span class="op">/</span>N,rw5<span class="op">$</span>acp<span class="op">/</span>N,rw6<span class="op">$</span>acp<span class="op">/</span>N),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.9805 0.8375 0.6890 0.5305 0.1615 0.1015</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=1&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw5<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=9&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw6<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(\sigma=0.05\)</span>, it seems that almost every candidate point is accepted and it has not converged to the target. However, when <span class="math inline">\(\sigma=0.5\)</span>, the chain converges but it works slower than the situation where <span class="math inline">\(\sigma=1\)</span> and <span class="math inline">\(\sigma=2\)</span>. If we choose larger <span class="math inline">\(\sigma\)</span>, the chain converges but it is inefficient.</p>
</div>
<div id="question-2-7" class="section level2">
<h2>Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\sigma=0.5\)</span></li>
</ol>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="co">#define a function to calculate the diagnostic statstics</span></span>
<span id="cb117-2"><a href="#cb117-2"></a>Gelman.Rubin=<span class="cf">function</span>(psi) { </span>
<span id="cb117-3"><a href="#cb117-3"></a>psi=<span class="kw">as.matrix</span>(psi)</span>
<span id="cb117-4"><a href="#cb117-4"></a>n=<span class="kw">ncol</span>(psi)</span>
<span id="cb117-5"><a href="#cb117-5"></a>k=<span class="kw">nrow</span>(psi)</span>
<span id="cb117-6"><a href="#cb117-6"></a></span>
<span id="cb117-7"><a href="#cb117-7"></a>psi.means=<span class="kw">rowMeans</span>(psi)</span>
<span id="cb117-8"><a href="#cb117-8"></a>B=n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</span>
<span id="cb117-9"><a href="#cb117-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb117-10"><a href="#cb117-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</span>
<span id="cb117-11"><a href="#cb117-11"></a>v.hat=W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) </span>
<span id="cb117-12"><a href="#cb117-12"></a>r.hat=v.hat <span class="op">/</span><span class="st"> </span>W</span>
<span id="cb117-13"><a href="#cb117-13"></a><span class="kw">return</span>(r.hat) </span>
<span id="cb117-14"><a href="#cb117-14"></a>}</span>
<span id="cb117-15"><a href="#cb117-15"></a><span class="co">#choose sigma</span></span>
<span id="cb117-16"><a href="#cb117-16"></a>sig=<span class="fl">0.9</span></span>
<span id="cb117-17"><a href="#cb117-17"></a>k=<span class="dv">4</span></span>
<span id="cb117-18"><a href="#cb117-18"></a>n=<span class="dv">15000</span></span>
<span id="cb117-19"><a href="#cb117-19"></a>b=<span class="dv">1000</span></span>
<span id="cb117-20"><a href="#cb117-20"></a><span class="kw">set.seed</span>(<span class="dv">12354</span>)</span>
<span id="cb117-21"><a href="#cb117-21"></a><span class="co">#choose initial values</span></span>
<span id="cb117-22"><a href="#cb117-22"></a>x0=<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb117-23"><a href="#cb117-23"></a>chain=<span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb117-24"><a href="#cb117-24"></a><span class="co">#generate chains</span></span>
<span id="cb117-25"><a href="#cb117-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb117-26"><a href="#cb117-26"></a>  chain[i,]=<span class="kw">LRWM</span>(sig,x0[i],n)<span class="op">$</span>x</span>
<span id="cb117-27"><a href="#cb117-27"></a>}</span>
<span id="cb117-28"><a href="#cb117-28"></a><span class="co">#calculate the statistics</span></span>
<span id="cb117-29"><a href="#cb117-29"></a>psi=<span class="kw">t</span>(<span class="kw">apply</span>(chain, <span class="dv">1</span>, cumsum)) </span>
<span id="cb117-30"><a href="#cb117-30"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) </span>
<span id="cb117-31"><a href="#cb117-31"></a>  psi[i,]=<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb117-32"><a href="#cb117-32"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.174739</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="co">#plot psi for the four chains </span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) </span>
<span id="cb119-4"><a href="#cb119-4"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb120-2"><a href="#cb120-2"></a></span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb120-4"><a href="#cb120-4"></a>rhat=<span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb120-5"><a href="#cb120-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) </span>
<span id="cb120-6"><a href="#cb120-6"></a> rhat[j]=<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j]) </span>
<span id="cb120-7"><a href="#cb120-7"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb120-8"><a href="#cb120-8"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb120-9"><a href="#cb120-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that when <span class="math inline">\(\sigma=0.9\)</span>, the value <span class="math inline">\(\hat R\)</span> should be smaller than 1.2 at the time <span class="math inline">\(n&gt;7000\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(\sigma=2\)</span></li>
</ol>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="co">#choose sigma </span></span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="kw">set.seed</span>(<span class="dv">12354</span>)</span>
<span id="cb121-3"><a href="#cb121-3"></a>sig=<span class="dv">2</span></span>
<span id="cb121-4"><a href="#cb121-4"></a>k=<span class="dv">4</span></span>
<span id="cb121-5"><a href="#cb121-5"></a>n=<span class="dv">15000</span></span>
<span id="cb121-6"><a href="#cb121-6"></a>b=<span class="dv">1000</span></span>
<span id="cb121-7"><a href="#cb121-7"></a><span class="co">#choose initial values</span></span>
<span id="cb121-8"><a href="#cb121-8"></a>x0=<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb121-9"><a href="#cb121-9"></a>chain=<span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb121-10"><a href="#cb121-10"></a><span class="co">#generate chains</span></span>
<span id="cb121-11"><a href="#cb121-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb121-12"><a href="#cb121-12"></a>  chain[i,]=<span class="kw">LRWM</span>(sig,x0[i],n)<span class="op">$</span>x</span>
<span id="cb121-13"><a href="#cb121-13"></a>}</span>
<span id="cb121-14"><a href="#cb121-14"></a><span class="co">#calculate the statistics</span></span>
<span id="cb121-15"><a href="#cb121-15"></a>psi=<span class="kw">t</span>(<span class="kw">apply</span>(chain, <span class="dv">1</span>, cumsum)) </span>
<span id="cb121-16"><a href="#cb121-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) </span>
<span id="cb121-17"><a href="#cb121-17"></a>  psi[i,]=<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb121-18"><a href="#cb121-18"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.082282</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co">#plot psi for the four chains </span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>)) </span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) </span>
<span id="cb123-4"><a href="#cb123-4"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb124-2"><a href="#cb124-2"></a></span>
<span id="cb124-3"><a href="#cb124-3"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb124-4"><a href="#cb124-4"></a>rhat=<span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb124-5"><a href="#cb124-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) </span>
<span id="cb124-6"><a href="#cb124-6"></a>  rhat[j]=<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j]) </span>
<span id="cb124-7"><a href="#cb124-7"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb124-8"><a href="#cb124-8"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>) </span>
<span id="cb124-9"><a href="#cb124-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that when <span class="math inline">\(\sigma=2\)</span>, the value <span class="math inline">\(\hat R\)</span> should be smaller than 1.2 at the time <span class="math inline">\(n&gt;2000\)</span>. In addition, it converges faster than the case where <span class="math inline">\(\sigma=0.5\)</span></p>
</div>
<div id="question-3-6" class="section level2">
<h2>Question 3</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt k)\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_k(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}),\]</span> for<span class="math inline">\(k =4: 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3</h2>
<p>It is obviously that when <span class="math inline">\(a=0\)</span>, <span class="math inline">\(S_{k-1}(a)=S_k(a)\)</span>, so I change the lower from 0 to 0.1 and calculate <span class="math inline">\(S_{k-1}(a)-S_k(a)\)</span> to make sure that the values are positive. In addition, when <span class="math inline">\(a \rightarrow \sqrt k\)</span>, <span class="math inline">\(\sqrt{\frac{a^2(k-1)}{k-a^2}}\rightarrow \infty\)</span> and <span class="math inline">\(S_{k-1}(a)-S_k(a)&lt;0\)</span>. So I change the upper from <span class="math inline">\(\sqrt{k}\)</span> to <span class="math inline">\(\sqrt{k}-0.01\)</span> calculate <span class="math inline">\(S_{k-1}(a)-S_k(a)\)</span> to make sure that the values are negative. Thus I can use the uniroot function to calculate the solutions.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>k=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb125-2"><a href="#cb125-2"></a>S =<span class="st"> </span><span class="cf">function</span>(a,k){</span>
<span id="cb125-3"><a href="#cb125-3"></a> ck =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb125-4"><a href="#cb125-4"></a> <span class="kw">pt</span>(ck,<span class="dt">df=</span>k,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb125-5"><a href="#cb125-5"></a>}</span>
<span id="cb125-6"><a href="#cb125-6"></a></span>
<span id="cb125-7"><a href="#cb125-7"></a>f =<span class="st"> </span><span class="cf">function</span>(a,k){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)}</span>
<span id="cb125-8"><a href="#cb125-8"></a><span class="co">#curve(f(x),xlim = c(0,sqrt(k)))</span></span>
<span id="cb125-9"><a href="#cb125-9"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb125-10"><a href="#cb125-10"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb125-11"><a href="#cb125-11"></a><span class="kw">plot</span>(a, <span class="kw">f</span>(a, k[<span class="dv">23</span>]), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">xlab=</span><span class="st">&quot;a&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;f(a|k)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;f(a) with different k&quot;</span>)</span>
<span id="cb125-12"><a href="#cb125-12"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">24</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb125-13"><a href="#cb125-13"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">25</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>solve =<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb126-2"><a href="#cb126-2"></a>  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</span>
<span id="cb126-3"><a href="#cb126-3"></a>  output<span class="op">$</span>root</span>
<span id="cb126-4"><a href="#cb126-4"></a>}</span>
<span id="cb126-5"><a href="#cb126-5"></a>root =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</span>
<span id="cb126-6"><a href="#cb126-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb126-7"><a href="#cb126-7"></a>  root[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve</span>(k[i]),<span class="dv">4</span>)</span>
<span id="cb126-8"><a href="#cb126-8"></a>}</span>
<span id="cb126-9"><a href="#cb126-9"></a>root[<span class="dv">1</span>,] =<span class="st"> </span>k</span>
<span id="cb126-10"><a href="#cb126-10"></a><span class="kw">rownames</span>(root) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>)</span>
<span id="cb126-11"><a href="#cb126-11"></a>root</span></code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]    [,7]    [,8]   [,9]   [,10]
## k    4.0000 5.0000 6.0000 7.0000 8.0000 9.0000 10.0000 11.0000 12.000 13.0000
## A(k) 1.4921 1.5336 1.5627 1.5844 1.6012 1.6145  1.6254  1.6344  1.642  1.6486
##        [,11]   [,12]   [,13]   [,14]   [,15]   [,16]   [,17]   [,18]   [,19]
## k    14.0000 15.0000 16.0000 17.0000 18.0000 19.0000 20.0000 21.0000 22.0000
## A(k)  1.6542  1.6591  1.6635  1.6673  1.6707  1.6738  1.6766  1.6792  1.6815
##        [,20]   [,21]   [,22]    [,23]    [,24]     [,25]
## k    23.0000 24.0000 25.0000 100.0000 500.0000 1000.0000
## A(k)  1.6836  1.6856  1.6874   1.7206   1.7298    1.7309</code></pre>
<p>We can find that the for each k, the value of the function at the new upper and lower has opposite signs. So we can use the function ‘uniroot’ to calculate the intersection points.</p>
</div>
<div id="homework-2020-11-24" class="section level2">
<h2>Homework-2020-11-24</h2>
</div>
<div id="question-1-8" class="section level2">
<h2>Question 1</h2>
<p>A-B-O blood type problem</p>
<p>Let the three alleles be A, B, and O.</p>
<p>Observed data: <span class="math inline">\(n_A.=n_{AA}+n_{AO}=444\)</span>(A-type), <span class="math inline">\(n_B.=n_{BB}+n_{BO}=132\)</span>(B-type), <span class="math inline">\(n_{OO}=361\)</span>(O-type), <span class="math inline">\(n_{AB}=63\)</span>(AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1</h2>
<p><span class="math display">\[L(p,q)=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}\]</span> <span class="math display">\[lnL(p,q)=2n_{AA}lnp+2n_{BB}lnq+2n_{oo}lnr+n_{AO}ln2pr+n_{BO}ln2qr+n_{AB}ln2pq\]</span> <span class="math display">\[lnL_o=n_A.ln[p(p+2r)]+n_B.ln[q(q+2r)]+2n_{oo}lnr+n_{AB}ln2pq\]</span> <span class="math display">\[n_{AA} \sim B(n_A., \frac{p^2}{p^2+2pr});n_{BB} \sim B(n_B., \frac{q^2}{q^2+2qr})\]</span> <span class="math display">\[En_{AA}=\frac{n_A.p^2}{p^2+2pr};En_{BB}=\frac{n_B.q^2}{q^2+2qr}\]</span> <span class="math display">\[E[lnL(p,q)|]=2lnpEn_{AA}+2lnqEn_{BB}+2n_{oo}lnr+(n_A.-En_{AA})ln2pr+(n_B.-En_{BB})ln2qr+n_{AB}ln2pq\]</span> <span class="math display">\[E[lnL(p,q)|]=2n_{oo}lnr+n_{AB}ln2pq+n_A.ln2pr+n_B.ln2qr+(2lnp-ln2pr)En_{AA}+(2lnq-ln2qr)En_{BB}\]</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>nA=<span class="dv">444</span>;</span>
<span id="cb128-2"><a href="#cb128-2"></a>nB=<span class="dv">132</span>;</span>
<span id="cb128-3"><a href="#cb128-3"></a>noo=<span class="dv">361</span>;</span>
<span id="cb128-4"><a href="#cb128-4"></a>nAB=<span class="dv">63</span>;</span>
<span id="cb128-5"><a href="#cb128-5"></a><span class="co">#calculate the expectation of nAA</span></span>
<span id="cb128-6"><a href="#cb128-6"></a>EnAA=<span class="cf">function</span>(p){</span>
<span id="cb128-7"><a href="#cb128-7"></a>  nA<span class="op">*</span>p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)</span>
<span id="cb128-8"><a href="#cb128-8"></a>}</span>
<span id="cb128-9"><a href="#cb128-9"></a><span class="co">#calculate the expectation of nBB</span></span>
<span id="cb128-10"><a href="#cb128-10"></a>EnBB=<span class="cf">function</span>(q){</span>
<span id="cb128-11"><a href="#cb128-11"></a>  nB<span class="op">*</span>q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)</span>
<span id="cb128-12"><a href="#cb128-12"></a>}</span>
<span id="cb128-13"><a href="#cb128-13"></a>omle=<span class="cf">function</span>(p,q){</span>
<span id="cb128-14"><a href="#cb128-14"></a>nA<span class="op">*</span><span class="kw">log</span>(p<span class="op">*</span>(p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r)) <span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(q<span class="op">*</span>(q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q) </span>
<span id="cb128-15"><a href="#cb128-15"></a>}</span>
<span id="cb128-16"><a href="#cb128-16"></a>obj=<span class="cf">function</span>(x){<span class="co">#def the opposite MLE</span></span>
<span id="cb128-17"><a href="#cb128-17"></a>  p=x[<span class="dv">1</span>];</span>
<span id="cb128-18"><a href="#cb128-18"></a>  q=x[<span class="dv">2</span>];</span>
<span id="cb128-19"><a href="#cb128-19"></a>  r=<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q;</span>
<span id="cb128-20"><a href="#cb128-20"></a>  y=<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span>nA<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r))<span class="op">*</span><span class="kw">EnAA</span>(pi)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(q)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r))<span class="op">*</span><span class="kw">EnBB</span>(qi))<span class="co">#we need to change the values of pi and qi in the algorithm</span></span>
<span id="cb128-21"><a href="#cb128-21"></a>}</span>
<span id="cb128-22"><a href="#cb128-22"></a><span class="co">#set the initial p and q</span></span>
<span id="cb128-23"><a href="#cb128-23"></a><span class="co">#the initial value of p and q are saved in p[2] and q[2] </span></span>
<span id="cb128-24"><a href="#cb128-24"></a>p0=<span class="fl">0.2</span>;</span>
<span id="cb128-25"><a href="#cb128-25"></a>q0=<span class="fl">0.2</span>;</span>
<span id="cb128-26"><a href="#cb128-26"></a>R=<span class="dv">20</span><span class="co">#maximum number of cycles</span></span>
<span id="cb128-27"><a href="#cb128-27"></a>P=<span class="kw">numeric</span>(R<span class="op">+</span><span class="dv">1</span>);</span>
<span id="cb128-28"><a href="#cb128-28"></a>Q=<span class="kw">numeric</span>(R<span class="op">+</span><span class="dv">1</span>);</span>
<span id="cb128-29"><a href="#cb128-29"></a>OMLE=<span class="kw">numeric</span>(R);</span>
<span id="cb128-30"><a href="#cb128-30"></a>P[<span class="dv">1</span>]=p0;</span>
<span id="cb128-31"><a href="#cb128-31"></a>Q[<span class="dv">1</span>]=q0;</span>
<span id="cb128-32"><a href="#cb128-32"></a>P[<span class="dv">2</span>]=p0<span class="fl">+0.01</span>;</span>
<span id="cb128-33"><a href="#cb128-33"></a>Q[<span class="dv">2</span>]=q0<span class="fl">+0.01</span>;</span>
<span id="cb128-34"><a href="#cb128-34"></a>i=<span class="dv">2</span>;</span>
<span id="cb128-35"><a href="#cb128-35"></a><span class="cf">while</span> ((<span class="kw">abs</span>(P[i]<span class="op">-</span>P[i<span class="dv">-1</span>])<span class="op">&gt;</span><span class="fl">1e-6</span>)<span class="op">||</span>(<span class="kw">abs</span>(Q[i]<span class="op">-</span>Q[i<span class="dv">-1</span>])<span class="op">&gt;</span><span class="fl">1e-6</span>)){</span>
<span id="cb128-36"><a href="#cb128-36"></a>  pi=P[i];</span>
<span id="cb128-37"><a href="#cb128-37"></a>  qi=Q[i];</span>
<span id="cb128-38"><a href="#cb128-38"></a>  r=<span class="dv">1</span><span class="op">-</span>pi<span class="op">-</span>qi;</span>
<span id="cb128-39"><a href="#cb128-39"></a>sol=<span class="kw">optim</span>(<span class="dt">par=</span><span class="kw">c</span>(p0,q0),<span class="dt">fn=</span>obj) <span class="co">#solve the minimum</span></span>
<span id="cb128-40"><a href="#cb128-40"></a><span class="co">#save the MLE at each step</span></span>
<span id="cb128-41"><a href="#cb128-41"></a>P[i<span class="op">+</span><span class="dv">1</span>]=sol<span class="op">$</span>par[<span class="dv">1</span>]  </span>
<span id="cb128-42"><a href="#cb128-42"></a>Q[i<span class="op">+</span><span class="dv">1</span>]=sol<span class="op">$</span>par[<span class="dv">2</span>]</span>
<span id="cb128-43"><a href="#cb128-43"></a>OMLE[i<span class="dv">-1</span>]=<span class="kw">omle</span>(P[i<span class="op">+</span><span class="dv">1</span>],Q[i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb128-44"><a href="#cb128-44"></a>i=i<span class="op">+</span><span class="dv">1</span>;</span>
<span id="cb128-45"><a href="#cb128-45"></a>}</span>
<span id="cb128-46"><a href="#cb128-46"></a>iter=i<span class="dv">-1</span></span>
<span id="cb128-47"><a href="#cb128-47"></a>P[<span class="dv">3</span><span class="op">:</span>i<span class="dv">-1</span>]</span></code></pre></div>
<pre><code>## [1] 0.2100000 0.2875502 0.2961257 0.2975555 0.2975897 0.2976713 0.2976647</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a>Q[<span class="dv">3</span><span class="op">:</span>i<span class="dv">-1</span>]</span></code></pre></div>
<pre><code>## [1] 0.2100000 0.1076525 0.1029213 0.1026522 0.1027260 0.1027072 0.1026713</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>OMLE[<span class="dv">1</span><span class="op">:</span>iter<span class="dv">-1</span>]</span></code></pre></div>
<pre><code>## [1] -1220.624 -1162.178 -1167.503 -1169.606 -1169.696 -1169.906 -1169.822</code></pre>
<p>The estimations of p and q are 0.2977 and 0.1027. The corresponding log-maximum likelihood values (for observed data) is increasing.</p>
</div>
<div id="question-2-8" class="section level2">
<h2>Question 2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-2-8" class="section level2">
<h2>Answer 2</h2>
<p>Loops:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>formulas=<span class="kw">list</span>(</span>
<span id="cb134-2"><a href="#cb134-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp, </span>
<span id="cb134-3"><a href="#cb134-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), </span>
<span id="cb134-4"><a href="#cb134-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, </span>
<span id="cb134-5"><a href="#cb134-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb134-6"><a href="#cb134-6"></a>)</span>
<span id="cb134-7"><a href="#cb134-7"></a>n=<span class="kw">length</span>(formulas)</span>
<span id="cb134-8"><a href="#cb134-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb134-9"><a href="#cb134-9"></a><span class="kw">print</span>(formulas[[i]])  </span>
<span id="cb134-10"><a href="#cb134-10"></a><span class="kw">print</span>(<span class="kw">lm</span>(formulas[[i]],<span class="dt">data=</span>mtcars))</span>
<span id="cb134-11"><a href="#cb134-11"></a>}</span></code></pre></div>
<pre><code>## mpg ~ disp
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## mpg ~ I(1/disp)
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## mpg ~ disp + wt
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## mpg ~ I(1/disp) + wt
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>lapply():</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>lr=<span class="cf">function</span>(f){ </span>
<span id="cb136-2"><a href="#cb136-2"></a>  <span class="kw">lm</span>(f, <span class="dt">data=</span>mtcars)}</span>
<span id="cb136-3"><a href="#cb136-3"></a><span class="kw">lapply</span>(formulas,lr)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-7" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
</div>
<div id="answer-3-7" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>trials=<span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(pv) pv<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.01796779 0.66844257 0.36816677 0.27003803 0.58187436 0.26333590
##   [7] 0.24404277 0.48721188 0.86550812 0.18074953 0.02731672 0.47177401
##  [13] 0.13249107 0.68784917 0.25748985 0.89997095 0.95459630 0.45621014
##  [19] 0.44048480 0.44573433 0.66152606 0.73303571 0.74316807 0.31213487
##  [25] 0.06195399 0.82101951 0.20837769 0.55452628 0.88777198 0.71573194
##  [31] 0.07224208 0.26561230 0.87884844 0.48294465 0.50514149 0.76313919
##  [37] 0.91511417 0.56102140 0.78061685 0.57782635 0.58638654 0.47183892
##  [43] 0.85000828 0.53201653 0.99021096 0.26291886 0.42885752 0.88084396
##  [49] 0.87691025 0.41070456 0.01812532 0.72092694 0.55549544 0.44642586
##  [55] 0.30574318 0.92275713 0.45113092 0.30309627 0.55553001 0.87786655
##  [61] 0.47737887 0.78943974 0.99108742 0.53469361 0.49267680 0.44524104
##  [67] 0.82681294 0.23734980 0.01307689 0.61056854 0.74563528 0.08238247
##  [73] 0.68619425 0.15236399 0.72662320 0.16448602 0.92429034 0.92968684
##  [79] 0.46427564 0.18559962 0.48987873 0.23040256 0.56109050 0.76645461
##  [85] 0.72018246 0.99437362 0.35993066 0.41817147 0.86934957 0.65696790
##  [91] 0.30482230 0.59059083 0.93764207 0.49676056 0.87832186 0.07017272
##  [97] 0.58814386 0.17476627 0.54301966 0.52815794</code></pre>
</div>
<div id="question-4-4" class="section level2">
<h2>Question 4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-4-4" class="section level2">
<h2>Answer 4</h2>
<p>Use the example in class, compute the weighted means. Use the function Map() to calculate the imput and use vapply() to convert the result from list to a vector.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>xs=<span class="kw">list</span>(<span class="kw">runif</span>(<span class="dv">10</span>), <span class="kw">runif</span>(<span class="dv">5</span>)) </span>
<span id="cb140-2"><a href="#cb140-2"></a>ws=<span class="kw">list</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">rpois</span>(<span class="dv">5</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb140-3"><a href="#cb140-3"></a><span class="kw">vapply</span>(<span class="kw">Map</span>(weighted.mean,xs,ws),<span class="cf">function</span>(x) x,<span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">wm1=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 0.5098832 0.3800503</code></pre>
</div>
<div id="homework-2020-12-01" class="section level2">
<h2>Homework-2020-12-01</h2>
</div>
<div id="question-1-9" class="section level2">
<h2>Question 1</h2>
<p>Write an Rcpp function for Exercise 9.4</p>
</div>
<div id="answer-1-9" class="section level2">
<h2>Answer 1</h2>
<p>Use Rcpp:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="kw">library</span>(StatComp20087)</span>
<span id="cb142-2"><a href="#cb142-2"></a></span>
<span id="cb142-3"><a href="#cb142-3"></a>sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">16</span>)</span>
<span id="cb142-4"><a href="#cb142-4"></a>x0=<span class="dv">0</span></span>
<span id="cb142-5"><a href="#cb142-5"></a>N=<span class="dv">2000</span></span>
<span id="cb142-6"><a href="#cb142-6"></a>rw1=<span class="kw">LARMC</span>(sigma[<span class="dv">1</span>], x0, N) </span>
<span id="cb142-7"><a href="#cb142-7"></a>rw2=<span class="kw">LARMC</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb142-8"><a href="#cb142-8"></a>rw3=<span class="kw">LARMC</span>(sigma[<span class="dv">3</span>], x0, N) </span>
<span id="cb142-9"><a href="#cb142-9"></a>rw4=<span class="kw">LARMC</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb142-10"><a href="#cb142-10"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>));</span>
<span id="cb142-11"><a href="#cb142-11"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw1,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>); <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw2,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=1&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>); <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw3,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=9&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>); <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw4,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-9" class="section level2">
<h2>Question 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
</div>
<div id="answer-2-9" class="section level2">
<h2>Answer 2</h2>
<p>The function wrote before:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>La=<span class="cf">function</span>(x){</span>
<span id="cb143-2"><a href="#cb143-2"></a>  <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb143-3"><a href="#cb143-3"></a>}</span>
<span id="cb143-4"><a href="#cb143-4"></a><span class="co">#define a function to generate the chain</span></span>
<span id="cb143-5"><a href="#cb143-5"></a><span class="co">#x0: initial value;</span></span>
<span id="cb143-6"><a href="#cb143-6"></a><span class="co">#N: the length of the chain</span></span>
<span id="cb143-7"><a href="#cb143-7"></a>LRWMR=<span class="cf">function</span>(sigma, x0, N) { </span>
<span id="cb143-8"><a href="#cb143-8"></a>x=<span class="kw">numeric</span>(N)</span>
<span id="cb143-9"><a href="#cb143-9"></a>x[<span class="dv">1</span>]=x0</span>
<span id="cb143-10"><a href="#cb143-10"></a>u=<span class="kw">runif</span>(N)</span>
<span id="cb143-11"><a href="#cb143-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) { </span>
<span id="cb143-12"><a href="#cb143-12"></a>  y=<span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </span>
<span id="cb143-13"><a href="#cb143-13"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">La</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">La</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb143-14"><a href="#cb143-14"></a>  {x[i]=y</span>
<span id="cb143-15"><a href="#cb143-15"></a>   } </span>
<span id="cb143-16"><a href="#cb143-16"></a>  <span class="cf">else</span> {</span>
<span id="cb143-17"><a href="#cb143-17"></a>    x[i]=x[i<span class="dv">-1</span>] </span>
<span id="cb143-18"><a href="#cb143-18"></a>  } </span>
<span id="cb143-19"><a href="#cb143-19"></a>  }</span>
<span id="cb143-20"><a href="#cb143-20"></a><span class="kw">return</span>(x) </span>
<span id="cb143-21"><a href="#cb143-21"></a>}</span>
<span id="cb143-22"><a href="#cb143-22"></a><span class="kw">par</span>(<span class="dt">pin=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">0.75</span>))</span>
<span id="cb143-23"><a href="#cb143-23"></a>sigma=<span class="fl">0.05</span>;</span>
<span id="cb143-24"><a href="#cb143-24"></a>X1=<span class="kw">LRWMR</span>(sigma, x0, N);</span>
<span id="cb143-25"><a href="#cb143-25"></a>X2=<span class="kw">LARMC</span>(sigma, x0, N);</span>
<span id="cb143-26"><a href="#cb143-26"></a><span class="kw">qqplot</span>(X1,X2,<span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZjpmkJBmkLZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2Zma2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb/7bb////tmb/25D/27b//7b//9v///8YWWbWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIfElEQVR4nO2dbXvaNhhGxZYMtrRbF9ptLevWlW5L6cuAgP//T5tk2WCMpVuyJVlu7/OhV0yE/OhUryAroiBWxNgB5A4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgjaDjStxu+73znRCz37Zd1xtRMg8ToonMBck3XkhoXq+/IEG92YjZm+KDEK+urw9LcZ8ggqiCPtzJ9vDTw6kGqfZx83YtvnkvSzf/dCdmL4sPC/mSSvzpuawOT+WP+4WuGmL2Vr5vXr67qibNa5nsle3mgYgpqOokvnlfCdLtY3anBWnuqhTFrpbSFFTVknXdQJvX8g1PpNGHiAVQRBSkasm2+ChkmbQgWaT59rgWlaB79TvxUnksU3y3VW7um4LKayVEKSyKonm9PhmNSkRBsjQ3/+oftSBdTummFCRf0P9WpS6Kz//ctfpci6Dj68XNQ/Fp0Xd4dCWiIN2ivlVjcimoHsrqPkjXsbrUx9cdg5KtBmk2satQzD7o8bluBH9pQVqHQZCyefPnZ/WCYxPT7KYsSCr6Q3XCVeWx1iBd9ENLkK2T1kxckOT4u+owOvqgS0G7cm7T7qRPo995mK+v9y8WrcoUh4iCZJl/3qp2Vleey1Hsqgbdbh9X7YnxppwqKXk6i4trOWf8uJjyTPrdaSDumgdd90EdK4fz0qKZRZmoqmiRB7G4Teyj6oGeXs6kf3wwj2I3bzbtFnN8t9CL01MWi3qx+vhC2n4W2c8Ya7F19P/1kKQUJHufZ2WFidxtBCWloN1pdEp406EkbWKPLxbV8n46ZP550PhQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECCUIJEbgcoVTlCgfAZRqxEB4/mSBJ0rj6CgjggEBVkDoCDb3S/7Z/ZB7Ztfj2AU1Lh11/hOQec7d05/KKi+r2F6mIug8DPXvvdvxZCLoOD5eN7VuLpIK+iwVA/WqG3OxkdrRhBkthMyHndBG/UAwWFpeNI4uSBT5xM6HmdBlZqN4TmLpILa856Om6cXtF+UgnaGRpZQ0JWernt/tTXo2k73nVMLUoHMi7q7jhmQjQ47pvlF8mFeOpq9lQOZ6biMBII69Zju+xXOgzzshIxnMoK89IwoaDPSKOYjJ2g8E1mLeerJR1DwfAy5+9kJGc8kBPnaCRmPY0b1c/8jLFa9K0/YeNwy2tTzH+NEKJog/9YVNh6hztHSiwjzKSHH1UlL2qWGd98cPh41Pz4s1SrCIqjxIUe6xarfvCdaPGWTOa7UwSo51aCOaaHfHcIJ0nVjfbu1CJJ9UFWFEvRBXW7851lha5BkPbcJKupj/YzHkgQKyGDHfx4aTlClpTwXakg+gwOxMEY8p4zq1nNc9RE0qBDtLAL6+UJm0thNb/ExBP2dtonFk9MvHpTRfpG0D4pqp0c85oyq046GHrfnNcuN68Y7HntG9dHDA4/Ncl9mJ7DjEw/OaCdmvww/NcsxoARqvOJxyuh80OWwfBwSxRfjFY9bRhtVgwaf9+kSUCo5rvG4ZVSf+DjwfHiXj4mT2XGLxzGjZKNYQjtO8fhmFH0elNCOUzz+GfWZSbsXOaWdYoJrsbR6Jiwo0O0gFITul1tGIJ/UfiYmKHUHVExMUOIBDMYzSka2vUwj+JmSoKTzQ4d4RsrImM84fib0KMI4frJ5FAGXfhQ9Ywjqt5F8JD1jCOrxKMJI3Y8xnngZ9alB4pJBQfYgtSBVRq9HEcRXJajwfhRhbD+5z4NG95O5oNH1jCgIP4qQgZ0i3xo0ftu6jCefjMp8crFT5CPowkY21afIR1Azn5z85CtovNXXVTwJMzr9bW9h/MCjXYNCxdeXxDUIb4FtCgoQ1mBSN7HjCmwhandAozNcTVUwx3Q7YTi0wy3DHF7tR/D2kIMKCur1aj988mo8FeWbYQ6v9oOCABQEoCAABQE4igEoCJDFwilnKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECCkoP0P9beL502N3ezE+SgDe1r3lH4ROBNQ0GF5+vp1/731JIed2u5Yl9ua1j2lXwTuhBO0a3xvb9pNrdGfTK7nOK17Sr8IPAgmaCfuz0FtrHVb70mvN/PZ0rqn9IvAg5B90Dm89RPZARg/wNbVv05tS+ue0i8CD6IIOizVfvy1KT7dqVRdizWte0q/CDyIU4O6Lhu/aBbbmtY9pV8EHkQUVD3+cs1lw7GldU/pF4EHAQRt6tbeDq9jpC3TXna9xrRFu5O2pdQ4ROBLlBqky2Ws4BeDtzWte0q/CDyINIqpIpm7yIvpnzWte0q/CNwJLkhv1lsLYduSttELCIe07in9InCGi1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHyELRf6BNQq79Ied6sOj55CKqO+Nwvyt0Gjc2q45OJoGItnVSHFO0s53qnJxdB6g9y641SF5tVxycXQbJ5/XraMEdBXWzOu3YpqIPjKsI2+QBkI2h9+9+y3h1PQdeoQ+ROx3lT0BX7RbmvsNquSUFtqoMs9QMEFHSF7KD1CL/Tj8BR0ISgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+BxxiBtEmVvARAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>sigma=<span class="dv">1</span>;</span>
<span id="cb144-2"><a href="#cb144-2"></a>X3=<span class="kw">LRWMR</span>(sigma, x0, N);</span>
<span id="cb144-3"><a href="#cb144-3"></a>X4=<span class="kw">LARMC</span>(sigma, x0, N);</span>
<span id="cb144-4"><a href="#cb144-4"></a><span class="kw">qqplot</span>(X3,X4,<span class="dt">main=</span><span class="st">&quot;sigma=1&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>sigma=<span class="dv">9</span>;</span>
<span id="cb145-2"><a href="#cb145-2"></a>X5=<span class="kw">LRWMR</span>(sigma, x0, N);</span>
<span id="cb145-3"><a href="#cb145-3"></a>X6=<span class="kw">LARMC</span>(sigma, x0, N);</span>
<span id="cb145-4"><a href="#cb145-4"></a><span class="kw">qqplot</span>(X5,X6,<span class="dt">main=</span><span class="st">&quot;sigma=9&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>sigma=<span class="dv">16</span>;</span>
<span id="cb146-2"><a href="#cb146-2"></a>X7=<span class="kw">LRWMR</span>(sigma, x0, N);</span>
<span id="cb146-3"><a href="#cb146-3"></a>X8=<span class="kw">LARMC</span>(sigma, x0, N);</span>
<span id="cb146-4"><a href="#cb146-4"></a><span class="kw">qqplot</span>(X7,X8,<span class="dt">main=</span><span class="st">&quot;sigma=16&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-8" class="section level2">
<h2>Question 3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-3-8" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>t=<span class="kw">microbenchmark</span>(<span class="kw">LRWMR</span>(sigma, x0, N),<span class="kw">LARMC</span>(sigma, x0, N))</span>
<span id="cb149-2"><a href="#cb149-2"></a><span class="kw">summary</span>(t)</span></code></pre></div>
<pre><code>##                  expr    min      lq      mean median      uq      max neval
## 1 LRWMR(sigma, x0, N) 8165.8 8542.65 11413.244 8909.1 9896.70 145612.8   100
## 2 LARMC(sigma, x0, N)  461.5  482.75   566.899  502.1  525.15   4706.6   100</code></pre>
</div>
<div id="question-4-5" class="section level2">
<h2>Question 4</h2>
<p>Comments your results.</p>
</div>
<div id="answer-4-5" class="section level2">
<h2>Answer 4</h2>
<p>In the answer 3 it is obvious that C++ is generally faster than R, and it is convenient for us to use Rcpp. Also, when <span class="math inline">\(\sigma=1\)</span>, the chain converges quickly. As a result, from the qq-plot we can find that the two groups of random numbers are almost from the same distribution. If the acceptence rate is high, the numbers from the two groups are close to each other.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
